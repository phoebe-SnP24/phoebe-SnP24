[]
|
+- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  ]
|  |
|  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  ]
|  |  |
|  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  ]
|  |  |  |
|  |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  ]
|  |  |  |  |
|  |  |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  ]
|  |  |  |  |  |
|  |  |  |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  ]
|  |  |  |  |  |  |
|  |  |  |  |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  ]
|  |  |  |  |  |  |  |
|  |  |  |  |  |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  ]
|  |  |  |  |  |  |  |  |
|  |  |  |  |  |  |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  ]
|  |  |  |  |  |  |  |  |  |
|  |  |  |  |  |  |  |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |  ]
|  |  |  |  |  |  |  |  |  |  |
|  |  |  |  |  |  |  |  |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |  |  ]
|  |  |  |  |  |  |  |  |  |  |  |
|  |  |  |  |  |  |  |  |  |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |  |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |  |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |  |  |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |  |  |  ]
|  |  |  |  |  |  |  |  |  |  |  |
|  |  |  |  |  |  |  |  |  |  |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  |     ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |  |     ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |  |     ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |  |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |  |     ]
|  |  |  |  |  |  |  |  |  |  |
|  |  |  |  |  |  |  |  |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |  |  ]
|  |  |  |  |  |  |  |  |  |  |  |
|  |  |  |  |  |  |  |  |  |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |  |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |  |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |  |  |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |  |  |  ]
|  |  |  |  |  |  |  |  |  |  |  |
|  |  |  |  |  |  |  |  |  |  |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  |     ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |  |     ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |  |     ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |  |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |  |     ]
|  |  |  |  |  |  |  |  |  |  |
|  |  |  |  |  |  |  |  |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |  |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |  |  ]
|  |  |  |  |  |  |  |  |  |  |  |
|  |  |  |  |  |  |  |  |  |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |  |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |  |  |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |  |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |  |  |  ]
|  |  |  |  |  |  |  |  |  |  |  |
|  |  |  |  |  |  |  |  |  |  |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  |     ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |  |     ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |  |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |  |     ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |  |     ]
|  |  |  |  |  |  |  |  |  |  |
|  |  |  |  |  |  |  |  |  |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |     ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |     ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |     ]
|  |  |  |  |  |  |  |  |  |     |
|  |  |  |  |  |  |  |  |  |     +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |     |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |     |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |     |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |     |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |     |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |     |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |     |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |     |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |     |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |     |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |     |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |     |  ]
|  |  |  |  |  |  |  |  |  |     |
|  |  |  |  |  |  |  |  |  |     `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |        ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |        ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |        ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |        ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |        ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |        ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |        ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |        ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |        ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |        ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |        ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |        ]
|  |  |  |  |  |  |  |  |  |
|  |  |  |  |  |  |  |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |  ]
|  |  |  |  |  |  |  |  |  |  |
|  |  |  |  |  |  |  |  |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |  |  ]
|  |  |  |  |  |  |  |  |  |  |  |
|  |  |  |  |  |  |  |  |  |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |  |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |  |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |  |  |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |  |  |  ]
|  |  |  |  |  |  |  |  |  |  |  |
|  |  |  |  |  |  |  |  |  |  |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  |     ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |  |     ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |  |     ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |  |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |  |     ]
|  |  |  |  |  |  |  |  |  |  |
|  |  |  |  |  |  |  |  |  |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |     ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |     ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk2)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |     ]
|  |  |  |  |  |  |  |  |  |     |
|  |  |  |  |  |  |  |  |  |     `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |        ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |        ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |        ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |        ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |        ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |        ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |        ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |        ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |        ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |        ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk2)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |        ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |        ]
|  |  |  |  |  |  |  |  |  |
|  |  |  |  |  |  |  |  |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |     ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk2)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |     ]
|  |  |  |  |  |  |  |  |     |
|  |  |  |  |  |  |  |  |     +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |     |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |     |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |     |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |     |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |     |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |     |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |     |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |     |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |     |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk2)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |     |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |     |  ]
|  |  |  |  |  |  |  |  |     |  |
|  |  |  |  |  |  |  |  |     |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |     |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |     |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |     |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |     |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |     |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |     |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |     |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |     |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |     |  |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk2)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |     |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |     |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |     |  |  ]
|  |  |  |  |  |  |  |  |     |  |
|  |  |  |  |  |  |  |  |     |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |     |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |     |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |     |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |     |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |     |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |     |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |     |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |     |     ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |     |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk2)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |     |     ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |     |     ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |     |     ]
|  |  |  |  |  |  |  |  |     |
|  |  |  |  |  |  |  |  |     `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |        ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |        ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |        ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |        ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |        ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |        ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |        ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |        ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |        ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk2)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |        ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |        ]
|  |  |  |  |  |  |  |  |        |
|  |  |  |  |  |  |  |  |        `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |           ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |           ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |           ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |           ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |           ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |           ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |           ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |           ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |           ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk2)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |           ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |           ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |           ]
|  |  |  |  |  |  |  |  |
|  |  |  |  |  |  |  |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     ]
|  |  |  |  |  |  |  |     |
|  |  |  |  |  |  |  |     +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |  ]
|  |  |  |  |  |  |  |     |  |
|  |  |  |  |  |  |  |     |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |  |  ]
|  |  |  |  |  |  |  |     |  |  |
|  |  |  |  |  |  |  |     |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |  |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |  |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |  |  |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |  |  |  ]
|  |  |  |  |  |  |  |     |  |  |
|  |  |  |  |  |  |  |     |  |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  |     ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |  |     ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |  |     ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |  |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |  |     ]
|  |  |  |  |  |  |  |     |  |
|  |  |  |  |  |  |  |     |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |  |  ]
|  |  |  |  |  |  |  |     |  |  |
|  |  |  |  |  |  |  |     |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |  |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |  |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |  |  |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |  |  |  ]
|  |  |  |  |  |  |  |     |  |  |
|  |  |  |  |  |  |  |     |  |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  |     ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |  |     ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |  |     ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |  |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |  |     ]
|  |  |  |  |  |  |  |     |  |
|  |  |  |  |  |  |  |     |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |  |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |  |  ]
|  |  |  |  |  |  |  |     |  |  |
|  |  |  |  |  |  |  |     |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |  |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |  |  |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |  |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |  |  |  ]
|  |  |  |  |  |  |  |     |  |  |
|  |  |  |  |  |  |  |     |  |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  |     ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |  |     ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |  |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |  |     ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |  |     ]
|  |  |  |  |  |  |  |     |  |
|  |  |  |  |  |  |  |     |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |     ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |     ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |     ]
|  |  |  |  |  |  |  |     |     |
|  |  |  |  |  |  |  |     |     +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |     |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |     |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |     |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |     |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |     |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |     |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |     |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |     |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |     |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |     |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |     |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |     |  ]
|  |  |  |  |  |  |  |     |     |
|  |  |  |  |  |  |  |     |     `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |        ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |        ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |        ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |        ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |        ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |        ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |        ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |        ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |        ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |        ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |        ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |        ]
|  |  |  |  |  |  |  |     |
|  |  |  |  |  |  |  |     +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: (kk1)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |  ]
|  |  |  |  |  |  |  |     |  |
|  |  |  |  |  |  |  |     |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: (kk1)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |  |  ]
|  |  |  |  |  |  |  |     |  |  |
|  |  |  |  |  |  |  |     |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |  |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: (kk1)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |  |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |  |  |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |  |  |  ]
|  |  |  |  |  |  |  |     |  |  |
|  |  |  |  |  |  |  |     |  |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  |     ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |  |     ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: (kk1)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |  |     ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |  |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |  |     ]
|  |  |  |  |  |  |  |     |  |
|  |  |  |  |  |  |  |     |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |     ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |     ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: (kk1)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |     ]
|  |  |  |  |  |  |  |     |     |
|  |  |  |  |  |  |  |     |     `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |        ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |        ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |        ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |        ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |        ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |        ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |        ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |        ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |        ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: (kk1)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |        ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |        ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |        ]
|  |  |  |  |  |  |  |     |
|  |  |  |  |  |  |  |     `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |        ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |        ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |        ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |        ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |        ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |        ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |        ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |        ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |        ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |        ]
|  |  |  |  |  |  |  |        |
|  |  |  |  |  |  |  |        +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |        |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |        |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |        |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |        |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |        |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |        |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |        |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |        |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |        |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |        |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |        |  ]
|  |  |  |  |  |  |  |        |  |
|  |  |  |  |  |  |  |        |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |        |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |        |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |        |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |        |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |        |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |        |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |        |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |        |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |        |  |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |        |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |        |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |        |  |  ]
|  |  |  |  |  |  |  |        |  |
|  |  |  |  |  |  |  |        |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |        |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |        |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |        |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |        |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |        |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |        |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |        |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |        |     ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |        |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |        |     ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |        |     ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |        |     ]
|  |  |  |  |  |  |  |        |
|  |  |  |  |  |  |  |        `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |           ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |           ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |           ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |           ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |           ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |           ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |           ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |           ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |           ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |           ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: (kk1)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |           ]
|  |  |  |  |  |  |  |           |
|  |  |  |  |  |  |  |           `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |              ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |              ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |              ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |              ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |              ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |              ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |              ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |              ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |              ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |              ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: (kk1)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |              ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |              ]
|  |  |  |  |  |  |  |
|  |  |  |  |  |  |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     ]
|  |  |  |  |  |  |     |
|  |  |  |  |  |  |     +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  ]
|  |  |  |  |  |  |     |  |
|  |  |  |  |  |  |     |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  ]
|  |  |  |  |  |  |     |  |  |
|  |  |  |  |  |  |     |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |  ]
|  |  |  |  |  |  |     |  |  |  |
|  |  |  |  |  |  |     |  |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |  |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |  |  ]
|  |  |  |  |  |  |     |  |  |  |
|  |  |  |  |  |  |     |  |  |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |     ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |     ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |     ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |     ]
|  |  |  |  |  |  |     |  |  |
|  |  |  |  |  |  |     |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |  ]
|  |  |  |  |  |  |     |  |  |  |
|  |  |  |  |  |  |     |  |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |  |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |  |  ]
|  |  |  |  |  |  |     |  |  |  |
|  |  |  |  |  |  |     |  |  |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |     ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |     ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |     ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |     ]
|  |  |  |  |  |  |     |  |  |
|  |  |  |  |  |  |     |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |  ]
|  |  |  |  |  |  |     |  |  |  |
|  |  |  |  |  |  |     |  |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |  |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |  |  ]
|  |  |  |  |  |  |     |  |  |  |
|  |  |  |  |  |  |     |  |  |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |     ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |     ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |     ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |     ]
|  |  |  |  |  |  |     |  |  |
|  |  |  |  |  |  |     |  |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |     ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |     ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |     ]
|  |  |  |  |  |  |     |  |     |
|  |  |  |  |  |  |     |  |     +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |     |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |     |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |     |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |     |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |     |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |     |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |     |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |     |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |     |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |     |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |     |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |     |  ]
|  |  |  |  |  |  |     |  |     |
|  |  |  |  |  |  |     |  |     `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |        ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |        ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |        ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |        ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |        ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |        ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |        ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |        ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |        ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |        ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |        ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |        ]
|  |  |  |  |  |  |     |  |
|  |  |  |  |  |  |     |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  ]
|  |  |  |  |  |  |     |  |  |
|  |  |  |  |  |  |     |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |  ]
|  |  |  |  |  |  |     |  |  |  |
|  |  |  |  |  |  |     |  |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |  |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |  |  ]
|  |  |  |  |  |  |     |  |  |  |
|  |  |  |  |  |  |     |  |  |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |     ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |     ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |     ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |     ]
|  |  |  |  |  |  |     |  |  |
|  |  |  |  |  |  |     |  |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |     ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |     ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk2)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |     ]
|  |  |  |  |  |  |     |  |     |
|  |  |  |  |  |  |     |  |     `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |        ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |        ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |        ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |        ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |        ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |        ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |        ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |        ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |        ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |        ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk2)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |        ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |        ]
|  |  |  |  |  |  |     |  |
|  |  |  |  |  |  |     |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |     ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk2)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |     ]
|  |  |  |  |  |  |     |     |
|  |  |  |  |  |  |     |     +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |     |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |     |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |     |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |     |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |     |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |     |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |     |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |     |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |     |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk2)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |     |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |     |     |  ]
|  |  |  |  |  |  |     |     |  |
|  |  |  |  |  |  |     |     |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |     |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |     |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |     |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |     |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |     |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |     |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |     |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |     |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |     |  |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk2)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |     |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |     |     |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |     |  |  ]
|  |  |  |  |  |  |     |     |  |
|  |  |  |  |  |  |     |     |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |     |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |     |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |     |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |     |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |     |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |     |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |     |     ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |     |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |     |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk2)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |     |     ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |     |     |     ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |     |     |     ]
|  |  |  |  |  |  |     |     |
|  |  |  |  |  |  |     |     `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |        ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |        ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |        ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |        ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |        ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |        ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |        ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |        ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |        ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk2)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |        ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |        ]
|  |  |  |  |  |  |     |        |
|  |  |  |  |  |  |     |        `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |           ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |           ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |           ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |           ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |           ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |           ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |           ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |           ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |           ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk2)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |           ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |           ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |     |           ]
|  |  |  |  |  |  |     |
|  |  |  |  |  |  |     +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  ]
|  |  |  |  |  |  |     |  |
|  |  |  |  |  |  |     |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  ]
|  |  |  |  |  |  |     |  |  |
|  |  |  |  |  |  |     |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |  ]
|  |  |  |  |  |  |     |  |  |  |
|  |  |  |  |  |  |     |  |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |  |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |  |  ]
|  |  |  |  |  |  |     |  |  |  |
|  |  |  |  |  |  |     |  |  |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |     ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |     ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |     ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |     ]
|  |  |  |  |  |  |     |  |  |
|  |  |  |  |  |  |     |  |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |     ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |     ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk2)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |     ]
|  |  |  |  |  |  |     |  |     |
|  |  |  |  |  |  |     |  |     `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |        ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |        ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |        ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |        ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |        ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |        ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |        ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |        ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |        ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |        ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk2)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |        ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |        ]
|  |  |  |  |  |  |     |  |
|  |  |  |  |  |  |     |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |     ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |     ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk2)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |     ]
|  |  |  |  |  |  |     |     |
|  |  |  |  |  |  |     |     `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |        ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |        ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |        ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |        ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |        ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |        ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |        ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |        ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |        ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk2)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |        ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |        ]
|  |  |  |  |  |  |     |        |
|  |  |  |  |  |  |     |        `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |           ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |           ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |           ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |           ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |           ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |           ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |           ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |           ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |           ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk2)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |           ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |           ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |     |           ]
|  |  |  |  |  |  |     |
|  |  |  |  |  |  |     `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |        ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |        ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |        ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |        ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |        ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |        ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |        ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |        ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk2)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |        ]
|  |  |  |  |  |  |        |
|  |  |  |  |  |  |        +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |        |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |        |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |        |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |        |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |        |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |        |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |        |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |        |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk2)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |        |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |        |  ]
|  |  |  |  |  |  |        |  |
|  |  |  |  |  |  |        |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |        |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |        |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |        |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |        |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |        |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |        |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |        |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |        |  |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk2)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |        |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |        |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |        |  |  ]
|  |  |  |  |  |  |        |  |  |
|  |  |  |  |  |  |        |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |        |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |        |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |        |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |        |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |        |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |        |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |        |  |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |        |  |  |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk2)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |        |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |        |  |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |        |  |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |        |  |  |  ]
|  |  |  |  |  |  |        |  |  |
|  |  |  |  |  |  |        |  |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |        |  |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |        |  |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |        |  |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |        |  |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |        |  |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |        |  |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |        |  |     ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |        |  |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk2)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |        |  |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |        |  |     ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |        |  |     ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |        |  |     ]
|  |  |  |  |  |  |        |  |
|  |  |  |  |  |  |        |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |        |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |        |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |        |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |        |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |        |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |        |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |        |     ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |        |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk2)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |        |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |        |     ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |        |     ]
|  |  |  |  |  |  |        |     |
|  |  |  |  |  |  |        |     `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |        |        ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |        |        ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |        |        ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |        |        ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |        |        ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |        |        ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |        |        ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |        |        ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk2)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |        |        ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |        |        ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |        |        ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |        |        ]
|  |  |  |  |  |  |        |
|  |  |  |  |  |  |        `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |           ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |           ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |           ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |           ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |           ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |           ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |           ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |           ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk2)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |           ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |           ]
|  |  |  |  |  |  |           |
|  |  |  |  |  |  |           `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |              ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |              ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |              ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |              ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |              ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |              ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |              ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |              ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk2)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |              ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |              ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |              ]
|  |  |  |  |  |  |              |
|  |  |  |  |  |  |              `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |                 ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |                 ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |                 ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |                 ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |                 ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |                 ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |                 ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |                 ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk2)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |                 ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |                 ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |                 ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |                 ]
|  |  |  |  |  |  |
|  |  |  |  |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  ]
|  |  |  |  |  |  |  |
|  |  |  |  |  |  |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     ]
|  |  |  |  |  |  |     |
|  |  |  |  |  |  |     +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: (kk1)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  ]
|  |  |  |  |  |  |     |  |
|  |  |  |  |  |  |     |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |     ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |     ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: (kk1)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |     ]
|  |  |  |  |  |  |     |
|  |  |  |  |  |  |     `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |        ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |        ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |        ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |        ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |        ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |        ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |        ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |        ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |        ]
|  |  |  |  |  |  |        |
|  |  |  |  |  |  |        `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |           ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |           ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |           ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |           ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |           ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |           ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |           ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |           ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |           ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: (kk1)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |           ]
|  |  |  |  |  |  |
|  |  |  |  |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  ]
|  |  |  |  |  |  |  |
|  |  |  |  |  |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  ]
|  |  |  |  |  |  |  |  |
|  |  |  |  |  |  |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  ]
|  |  |  |  |  |  |  |  |  |
|  |  |  |  |  |  |  |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |  ]
|  |  |  |  |  |  |  |  |  |  |
|  |  |  |  |  |  |  |  |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |  |  ]
|  |  |  |  |  |  |  |  |  |  |  |
|  |  |  |  |  |  |  |  |  |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |  |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |  |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |  |  |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |  |  |  ]
|  |  |  |  |  |  |  |  |  |  |  |
|  |  |  |  |  |  |  |  |  |  |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  |     ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |  |     ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |  |     ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |  |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |  |     ]
|  |  |  |  |  |  |  |  |  |  |
|  |  |  |  |  |  |  |  |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |  |  ]
|  |  |  |  |  |  |  |  |  |  |  |
|  |  |  |  |  |  |  |  |  |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |  |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |  |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |  |  |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |  |  |  ]
|  |  |  |  |  |  |  |  |  |  |  |
|  |  |  |  |  |  |  |  |  |  |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  |     ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |  |     ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |  |     ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |  |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |  |     ]
|  |  |  |  |  |  |  |  |  |  |
|  |  |  |  |  |  |  |  |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |  |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |  |  ]
|  |  |  |  |  |  |  |  |  |  |  |
|  |  |  |  |  |  |  |  |  |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |  |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |  |  |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |  |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |  |  |  ]
|  |  |  |  |  |  |  |  |  |  |  |
|  |  |  |  |  |  |  |  |  |  |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  |     ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |  |     ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |  |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |  |     ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |  |     ]
|  |  |  |  |  |  |  |  |  |  |
|  |  |  |  |  |  |  |  |  |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |     ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |     ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |     ]
|  |  |  |  |  |  |  |  |  |     |
|  |  |  |  |  |  |  |  |  |     +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |     |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |     |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |     |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |     |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |     |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |     |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |     |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |     |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |     |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |     |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |     |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |     |  ]
|  |  |  |  |  |  |  |  |  |     |
|  |  |  |  |  |  |  |  |  |     `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |        ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |        ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |        ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |        ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |        ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |        ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |        ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |        ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |        ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |        ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |        ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |        ]
|  |  |  |  |  |  |  |  |  |
|  |  |  |  |  |  |  |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: (kk1)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |  ]
|  |  |  |  |  |  |  |  |  |  |
|  |  |  |  |  |  |  |  |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: (kk1)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |  |  ]
|  |  |  |  |  |  |  |  |  |  |  |
|  |  |  |  |  |  |  |  |  |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |  |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: (kk1)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |  |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |  |  |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |  |  |  ]
|  |  |  |  |  |  |  |  |  |  |  |
|  |  |  |  |  |  |  |  |  |  |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  |     ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |  |     ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: (kk1)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |  |     ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |  |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |  |     ]
|  |  |  |  |  |  |  |  |  |  |
|  |  |  |  |  |  |  |  |  |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |     ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |     ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: (kk1)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |     ]
|  |  |  |  |  |  |  |  |  |     |
|  |  |  |  |  |  |  |  |  |     `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |        ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |        ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |        ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |        ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |        ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |        ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |        ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |        ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |        ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: (kk1)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |        ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |        ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |        ]
|  |  |  |  |  |  |  |  |  |
|  |  |  |  |  |  |  |  |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |     ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |     ]
|  |  |  |  |  |  |  |  |     |
|  |  |  |  |  |  |  |  |     +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |     |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |     |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |     |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |     |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |     |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |     |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |     |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |     |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |     |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |     |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |     |  ]
|  |  |  |  |  |  |  |  |     |  |
|  |  |  |  |  |  |  |  |     |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |     |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |     |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |     |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |     |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |     |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |     |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |     |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |     |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |     |  |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |     |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |     |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |     |  |  ]
|  |  |  |  |  |  |  |  |     |  |
|  |  |  |  |  |  |  |  |     |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |     |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |     |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |     |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |     |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |     |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |     |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |     |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |     |     ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |     |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |     |     ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |     |     ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |     |     ]
|  |  |  |  |  |  |  |  |     |
|  |  |  |  |  |  |  |  |     `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |        ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |        ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |        ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |        ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |        ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |        ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |        ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |        ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |        ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |        ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: (kk1)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |        ]
|  |  |  |  |  |  |  |  |        |
|  |  |  |  |  |  |  |  |        `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |           ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |           ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |           ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |           ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |           ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |           ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |           ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |           ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |           ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |           ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: (kk1)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |           ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |           ]
|  |  |  |  |  |  |  |  |
|  |  |  |  |  |  |  |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     ]
|  |  |  |  |  |  |  |     |
|  |  |  |  |  |  |  |     +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |  ]
|  |  |  |  |  |  |  |     |  |
|  |  |  |  |  |  |  |     |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |  |  ]
|  |  |  |  |  |  |  |     |  |  |
|  |  |  |  |  |  |  |     |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |  |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |  |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |  |  |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |  |  |  ]
|  |  |  |  |  |  |  |     |  |  |
|  |  |  |  |  |  |  |     |  |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  |     ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |  |     ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |  |     ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |  |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |  |     ]
|  |  |  |  |  |  |  |     |  |
|  |  |  |  |  |  |  |     |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |  |  ]
|  |  |  |  |  |  |  |     |  |  |
|  |  |  |  |  |  |  |     |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |  |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |  |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |  |  |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |  |  |  ]
|  |  |  |  |  |  |  |     |  |  |
|  |  |  |  |  |  |  |     |  |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  |     ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |  |     ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |  |     ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |  |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |  |     ]
|  |  |  |  |  |  |  |     |  |
|  |  |  |  |  |  |  |     |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |  |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |  |  ]
|  |  |  |  |  |  |  |     |  |  |
|  |  |  |  |  |  |  |     |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |  |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |  |  |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |  |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |  |  |  ]
|  |  |  |  |  |  |  |     |  |  |
|  |  |  |  |  |  |  |     |  |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  |     ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |  |     ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |  |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |  |     ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |  |     ]
|  |  |  |  |  |  |  |     |  |
|  |  |  |  |  |  |  |     |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |     ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |     ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |     ]
|  |  |  |  |  |  |  |     |     |
|  |  |  |  |  |  |  |     |     +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |     |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |     |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |     |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |     |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |     |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |     |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |     |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |     |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |     |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |     |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |     |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |     |  ]
|  |  |  |  |  |  |  |     |     |
|  |  |  |  |  |  |  |     |     `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |        ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |        ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |        ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |        ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |        ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |        ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |        ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |        ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |        ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |        ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |        ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |        ]
|  |  |  |  |  |  |  |     |
|  |  |  |  |  |  |  |     +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |  ]
|  |  |  |  |  |  |  |     |  |
|  |  |  |  |  |  |  |     |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |  |  ]
|  |  |  |  |  |  |  |     |  |  |
|  |  |  |  |  |  |  |     |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |  |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |  |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |  |  |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |  |  |  ]
|  |  |  |  |  |  |  |     |  |  |
|  |  |  |  |  |  |  |     |  |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  |     ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |  |     ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |  |     ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |  |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |  |     ]
|  |  |  |  |  |  |  |     |  |
|  |  |  |  |  |  |  |     |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |     ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |     ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk2)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |     ]
|  |  |  |  |  |  |  |     |     |
|  |  |  |  |  |  |  |     |     `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |        ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |        ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |        ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |        ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |        ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |        ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |        ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |        ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |        ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |        ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk2)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |        ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |        ]
|  |  |  |  |  |  |  |     |
|  |  |  |  |  |  |  |     `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |        ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |        ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |        ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |        ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |        ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |        ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |        ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |        ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |        ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk2)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |        ]
|  |  |  |  |  |  |  |        |
|  |  |  |  |  |  |  |        +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |        |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |        |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |        |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |        |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |        |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |        |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |        |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |        |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |        |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk2)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |        |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |        |  ]
|  |  |  |  |  |  |  |        |  |
|  |  |  |  |  |  |  |        |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |        |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |        |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |        |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |        |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |        |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |        |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |        |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |        |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |        |  |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk2)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |        |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |        |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |        |  |  ]
|  |  |  |  |  |  |  |        |  |
|  |  |  |  |  |  |  |        |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |        |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |        |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |        |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |        |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |        |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |        |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |        |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |        |     ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |        |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk2)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |        |     ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |        |     ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |        |     ]
|  |  |  |  |  |  |  |        |
|  |  |  |  |  |  |  |        `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |           ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |           ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |           ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |           ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |           ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |           ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |           ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |           ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |           ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk2)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |           ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |           ]
|  |  |  |  |  |  |  |           |
|  |  |  |  |  |  |  |           `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |              ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |              ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |              ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |              ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |              ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |              ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |              ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |              ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |              ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk2)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |              ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |              ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |              ]
|  |  |  |  |  |  |  |
|  |  |  |  |  |  |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     ]
|  |  |  |  |  |  |     |
|  |  |  |  |  |  |     +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  ]
|  |  |  |  |  |  |     |  |
|  |  |  |  |  |  |     |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  ]
|  |  |  |  |  |  |     |  |  |
|  |  |  |  |  |  |     |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |  ]
|  |  |  |  |  |  |     |  |  |  |
|  |  |  |  |  |  |     |  |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |  |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |  |  ]
|  |  |  |  |  |  |     |  |  |  |
|  |  |  |  |  |  |     |  |  |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |     ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |     ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |     ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |     ]
|  |  |  |  |  |  |     |  |  |
|  |  |  |  |  |  |     |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |  ]
|  |  |  |  |  |  |     |  |  |  |
|  |  |  |  |  |  |     |  |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |  |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |  |  ]
|  |  |  |  |  |  |     |  |  |  |
|  |  |  |  |  |  |     |  |  |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |     ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |     ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |     ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |     ]
|  |  |  |  |  |  |     |  |  |
|  |  |  |  |  |  |     |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |  ]
|  |  |  |  |  |  |     |  |  |  |
|  |  |  |  |  |  |     |  |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |  |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |  |  ]
|  |  |  |  |  |  |     |  |  |  |
|  |  |  |  |  |  |     |  |  |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |     ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |     ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |     ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |     ]
|  |  |  |  |  |  |     |  |  |
|  |  |  |  |  |  |     |  |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |     ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |     ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |     ]
|  |  |  |  |  |  |     |  |     |
|  |  |  |  |  |  |     |  |     +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |     |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |     |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |     |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |     |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |     |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |     |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |     |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |     |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |     |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |     |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |     |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |     |  ]
|  |  |  |  |  |  |     |  |     |
|  |  |  |  |  |  |     |  |     `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |        ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |        ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |        ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |        ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |        ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |        ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |        ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |        ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |        ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |        ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |        ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |        ]
|  |  |  |  |  |  |     |  |
|  |  |  |  |  |  |     |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  ]
|  |  |  |  |  |  |     |  |  |
|  |  |  |  |  |  |     |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |  ]
|  |  |  |  |  |  |     |  |  |  |
|  |  |  |  |  |  |     |  |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |  |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |  |  ]
|  |  |  |  |  |  |     |  |  |  |
|  |  |  |  |  |  |     |  |  |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |     ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |     ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |     ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |     ]
|  |  |  |  |  |  |     |  |  |
|  |  |  |  |  |  |     |  |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |     ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |     ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk2)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |     ]
|  |  |  |  |  |  |     |  |     |
|  |  |  |  |  |  |     |  |     `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |        ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |        ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |        ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |        ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |        ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |        ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |        ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |        ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |        ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |        ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk2)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |        ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |        ]
|  |  |  |  |  |  |     |  |
|  |  |  |  |  |  |     |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |     ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk2)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |     ]
|  |  |  |  |  |  |     |     |
|  |  |  |  |  |  |     |     +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |     |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |     |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |     |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |     |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |     |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |     |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |     |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |     |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |     |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk2)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |     |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |     |     |  ]
|  |  |  |  |  |  |     |     |  |
|  |  |  |  |  |  |     |     |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |     |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |     |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |     |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |     |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |     |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |     |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |     |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |     |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |     |  |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk2)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |     |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |     |     |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |     |  |  ]
|  |  |  |  |  |  |     |     |  |
|  |  |  |  |  |  |     |     |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |     |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |     |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |     |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |     |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |     |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |     |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |     |     ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |     |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |     |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk2)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |     |     ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |     |     |     ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |     |     |     ]
|  |  |  |  |  |  |     |     |
|  |  |  |  |  |  |     |     `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |        ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |        ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |        ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |        ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |        ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |        ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |        ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |        ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |        ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk2)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |        ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |        ]
|  |  |  |  |  |  |     |        |
|  |  |  |  |  |  |     |        `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |           ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |           ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |           ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |           ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |           ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |           ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |           ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |           ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |           ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk2)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |           ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |           ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |     |           ]
|  |  |  |  |  |  |     |
|  |  |  |  |  |  |     +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  ]
|  |  |  |  |  |  |     |  |
|  |  |  |  |  |  |     |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  ]
|  |  |  |  |  |  |     |  |  |
|  |  |  |  |  |  |     |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |  ]
|  |  |  |  |  |  |     |  |  |  |
|  |  |  |  |  |  |     |  |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |  |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |  |  ]
|  |  |  |  |  |  |     |  |  |  |
|  |  |  |  |  |  |     |  |  |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |     ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |     ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |     ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |     ]
|  |  |  |  |  |  |     |  |  |
|  |  |  |  |  |  |     |  |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |     ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |     ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk2)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |     ]
|  |  |  |  |  |  |     |  |     |
|  |  |  |  |  |  |     |  |     `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |        ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |        ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |        ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |        ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |        ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |        ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |        ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |        ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |        ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |        ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk2)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |        ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |        ]
|  |  |  |  |  |  |     |  |
|  |  |  |  |  |  |     |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |     ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |     ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk2)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |     ]
|  |  |  |  |  |  |     |     |
|  |  |  |  |  |  |     |     `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |        ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |        ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |        ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |        ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |        ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |        ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |        ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |        ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |        ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk2)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |        ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |        ]
|  |  |  |  |  |  |     |        |
|  |  |  |  |  |  |     |        `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |           ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |           ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |           ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |           ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |           ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |           ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |           ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |           ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |           ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk2)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |           ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |           ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |     |           ]
|  |  |  |  |  |  |     |
|  |  |  |  |  |  |     `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |        ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |        ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |        ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |        ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |        ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |        ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |        ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |        ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk2)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |        ]
|  |  |  |  |  |  |        |
|  |  |  |  |  |  |        +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |        |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |        |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |        |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |        |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |        |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |        |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |        |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |        |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk2)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |        |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |        |  ]
|  |  |  |  |  |  |        |  |
|  |  |  |  |  |  |        |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |        |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |        |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |        |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |        |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |        |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |        |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |        |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |        |  |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk2)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |        |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |        |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |        |  |  ]
|  |  |  |  |  |  |        |  |  |
|  |  |  |  |  |  |        |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |        |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |        |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |        |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |        |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |        |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |        |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |        |  |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |        |  |  |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk2)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |        |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |        |  |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |        |  |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |        |  |  |  ]
|  |  |  |  |  |  |        |  |  |
|  |  |  |  |  |  |        |  |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |        |  |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |        |  |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |        |  |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |        |  |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |        |  |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |        |  |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |        |  |     ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |        |  |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk2)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |        |  |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |        |  |     ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |        |  |     ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |        |  |     ]
|  |  |  |  |  |  |        |  |
|  |  |  |  |  |  |        |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |        |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |        |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |        |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |        |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |        |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |        |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |        |     ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |        |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk2)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |        |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |        |     ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |        |     ]
|  |  |  |  |  |  |        |     |
|  |  |  |  |  |  |        |     `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |        |        ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |        |        ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |        |        ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |        |        ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |        |        ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |        |        ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |        |        ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |        |        ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk2)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |        |        ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |        |        ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |        |        ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |        |        ]
|  |  |  |  |  |  |        |
|  |  |  |  |  |  |        `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |           ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |           ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |           ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |           ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |           ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |           ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |           ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |           ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk2)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |           ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |           ]
|  |  |  |  |  |  |           |
|  |  |  |  |  |  |           `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |              ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |              ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |              ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |              ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |              ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |              ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |              ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |              ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk2)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |              ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |              ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |              ]
|  |  |  |  |  |  |              |
|  |  |  |  |  |  |              `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |                 ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |                 ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |                 ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |                 ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |                 ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |                 ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |                 ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |                 ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk2)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |                 ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |                 ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |                 ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |                 ]
|  |  |  |  |  |  |
|  |  |  |  |  |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |     ]
|  |  |  |  |  |     |
|  |  |  |  |  |     `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |        ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |        ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |        ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |        ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |        ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |        ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |        ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |        ]
|  |  |  |  |  |        |
|  |  |  |  |  |        +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |        |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |        |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |        |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |        |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |        |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |        |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |        |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |        |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: (kk1)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |        |  ]
|  |  |  |  |  |        |  |
|  |  |  |  |  |        |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |        |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |        |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |        |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |        |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |        |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |        |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |        |     ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |        |     ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: (kk1)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |        |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |        |     ]
|  |  |  |  |  |        |
|  |  |  |  |  |        `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |           ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |           ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |           ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |           ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |           ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |           ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |           ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |           ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |           ]
|  |  |  |  |  |           |
|  |  |  |  |  |           `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |              ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |              ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |              ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |              ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |              ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |              ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |              ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |              ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |              ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: (kk1)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |              ]
|  |  |  |  |  |
|  |  |  |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  ]
|  |  |  |  |  |  |
|  |  |  |  |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  ]
|  |  |  |  |  |  |  |
|  |  |  |  |  |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  ]
|  |  |  |  |  |  |  |  |
|  |  |  |  |  |  |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  ]
|  |  |  |  |  |  |  |  |  |
|  |  |  |  |  |  |  |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |  ]
|  |  |  |  |  |  |  |  |  |  |
|  |  |  |  |  |  |  |  |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |  |  ]
|  |  |  |  |  |  |  |  |  |  |  |
|  |  |  |  |  |  |  |  |  |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |  |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |  |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |  |  |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |  |  |  ]
|  |  |  |  |  |  |  |  |  |  |  |
|  |  |  |  |  |  |  |  |  |  |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  |     ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |  |     ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |  |     ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |  |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |  |     ]
|  |  |  |  |  |  |  |  |  |  |
|  |  |  |  |  |  |  |  |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |  |  ]
|  |  |  |  |  |  |  |  |  |  |  |
|  |  |  |  |  |  |  |  |  |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |  |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |  |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |  |  |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |  |  |  ]
|  |  |  |  |  |  |  |  |  |  |  |
|  |  |  |  |  |  |  |  |  |  |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  |     ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |  |     ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |  |     ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |  |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |  |     ]
|  |  |  |  |  |  |  |  |  |  |
|  |  |  |  |  |  |  |  |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |  |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |  |  ]
|  |  |  |  |  |  |  |  |  |  |  |
|  |  |  |  |  |  |  |  |  |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |  |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |  |  |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |  |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |  |  |  ]
|  |  |  |  |  |  |  |  |  |  |  |
|  |  |  |  |  |  |  |  |  |  |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  |     ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |  |     ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |  |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |  |     ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |  |     ]
|  |  |  |  |  |  |  |  |  |  |
|  |  |  |  |  |  |  |  |  |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |     ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |     ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |     ]
|  |  |  |  |  |  |  |  |  |     |
|  |  |  |  |  |  |  |  |  |     +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |     |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |     |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |     |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |     |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |     |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |     |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |     |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |     |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |     |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |     |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |     |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |     |  ]
|  |  |  |  |  |  |  |  |  |     |
|  |  |  |  |  |  |  |  |  |     `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |        ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |        ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |        ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |        ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |        ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |        ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |        ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |        ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |        ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |        ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |        ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |        ]
|  |  |  |  |  |  |  |  |  |
|  |  |  |  |  |  |  |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |  ]
|  |  |  |  |  |  |  |  |  |  |
|  |  |  |  |  |  |  |  |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |  |  ]
|  |  |  |  |  |  |  |  |  |  |  |
|  |  |  |  |  |  |  |  |  |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |  |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |  |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |  |  |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |  |  |  ]
|  |  |  |  |  |  |  |  |  |  |  |
|  |  |  |  |  |  |  |  |  |  |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |  |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |  |     ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |  |     ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |  |     ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |  |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |  |     ]
|  |  |  |  |  |  |  |  |  |  |
|  |  |  |  |  |  |  |  |  |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |     ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |     ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk2)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |     ]
|  |  |  |  |  |  |  |  |  |     |
|  |  |  |  |  |  |  |  |  |     `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |        ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |        ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |        ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |  |        ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |        ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |        ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |        ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |  |        ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |        ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |        ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk2)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |        ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |  |        ]
|  |  |  |  |  |  |  |  |  |
|  |  |  |  |  |  |  |  |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |     ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk2)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |     ]
|  |  |  |  |  |  |  |  |     |
|  |  |  |  |  |  |  |  |     +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |     |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |     |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |     |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |     |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |     |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |     |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |     |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |     |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |     |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk2)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |     |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |     |  ]
|  |  |  |  |  |  |  |  |     |  |
|  |  |  |  |  |  |  |  |     |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |     |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |     |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |     |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |     |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |     |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |     |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |     |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |     |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |     |  |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk2)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |     |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |     |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |     |  |  ]
|  |  |  |  |  |  |  |  |     |  |
|  |  |  |  |  |  |  |  |     |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |     |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |     |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |     |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |     |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |     |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |     |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |     |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |     |     ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |     |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk2)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |     |     ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |     |     ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |     |     ]
|  |  |  |  |  |  |  |  |     |
|  |  |  |  |  |  |  |  |     `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |        ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |        ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |        ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |        ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |        ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |        ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |        ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |        ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |        ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk2)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |        ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |        ]
|  |  |  |  |  |  |  |  |        |
|  |  |  |  |  |  |  |  |        `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |           ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |           ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |           ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |  |           ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |           ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |           ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |           ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |  |           ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |           ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk2)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |           ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |           ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |  |           ]
|  |  |  |  |  |  |  |  |
|  |  |  |  |  |  |  |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     ]
|  |  |  |  |  |  |  |     |
|  |  |  |  |  |  |  |     +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |  ]
|  |  |  |  |  |  |  |     |  |
|  |  |  |  |  |  |  |     |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |  |  ]
|  |  |  |  |  |  |  |     |  |  |
|  |  |  |  |  |  |  |     |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |  |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |  |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |  |  |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |  |  |  ]
|  |  |  |  |  |  |  |     |  |  |
|  |  |  |  |  |  |  |     |  |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  |     ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |  |     ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |  |     ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |  |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |  |     ]
|  |  |  |  |  |  |  |     |  |
|  |  |  |  |  |  |  |     |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |  |  ]
|  |  |  |  |  |  |  |     |  |  |
|  |  |  |  |  |  |  |     |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |  |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |  |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |  |  |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |  |  |  ]
|  |  |  |  |  |  |  |     |  |  |
|  |  |  |  |  |  |  |     |  |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  |     ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |  |     ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |  |     ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |  |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |  |     ]
|  |  |  |  |  |  |  |     |  |
|  |  |  |  |  |  |  |     |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |  |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |  |  ]
|  |  |  |  |  |  |  |     |  |  |
|  |  |  |  |  |  |  |     |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |  |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |  |  |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |  |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |  |  |  ]
|  |  |  |  |  |  |  |     |  |  |
|  |  |  |  |  |  |  |     |  |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  |     ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |  |     ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |  |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |  |     ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |  |     ]
|  |  |  |  |  |  |  |     |  |
|  |  |  |  |  |  |  |     |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |     ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |     ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |     ]
|  |  |  |  |  |  |  |     |     |
|  |  |  |  |  |  |  |     |     +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |     |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |     |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |     |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |     |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |     |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |     |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |     |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |     |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |     |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |     |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |     |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |     |  ]
|  |  |  |  |  |  |  |     |     |
|  |  |  |  |  |  |  |     |     `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |        ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |        ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |        ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |        ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |        ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |        ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |        ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |        ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |        ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |        ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |        ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |        ]
|  |  |  |  |  |  |  |     |
|  |  |  |  |  |  |  |     +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: (kk1)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |  ]
|  |  |  |  |  |  |  |     |  |
|  |  |  |  |  |  |  |     |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: (kk1)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |  |  ]
|  |  |  |  |  |  |  |     |  |  |
|  |  |  |  |  |  |  |     |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |  |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: (kk1)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |  |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |  |  |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |  |  |  ]
|  |  |  |  |  |  |  |     |  |  |
|  |  |  |  |  |  |  |     |  |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |  |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |  |     ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |  |     ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: (kk1)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |  |     ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |  |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |  |     ]
|  |  |  |  |  |  |  |     |  |
|  |  |  |  |  |  |  |     |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |     ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |     ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: (kk1)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |     ]
|  |  |  |  |  |  |  |     |     |
|  |  |  |  |  |  |  |     |     `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |        ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |        ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |        ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |     |        ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |        ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |        ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |        ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |     |        ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |        ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: (kk1)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |        ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |        ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |     |        ]
|  |  |  |  |  |  |  |     |
|  |  |  |  |  |  |  |     `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |        ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |        ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |        ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |        ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |        ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |        ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |        ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |        ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |        ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |        ]
|  |  |  |  |  |  |  |        |
|  |  |  |  |  |  |  |        +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |        |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |        |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |        |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |        |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |        |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |        |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |        |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |        |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |        |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |        |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |        |  ]
|  |  |  |  |  |  |  |        |  |
|  |  |  |  |  |  |  |        |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |        |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |        |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |        |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |        |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |        |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |        |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |        |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |        |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |        |  |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |        |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |        |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |        |  |  ]
|  |  |  |  |  |  |  |        |  |
|  |  |  |  |  |  |  |        |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |        |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |        |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |        |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |        |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |        |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |        |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |        |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |        |     ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |        |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |        |     ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |        |     ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |        |     ]
|  |  |  |  |  |  |  |        |
|  |  |  |  |  |  |  |        `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |           ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |           ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |           ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |           ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |           ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |           ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |           ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |           ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |           ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |           ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: (kk1)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |           ]
|  |  |  |  |  |  |  |           |
|  |  |  |  |  |  |  |           `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |              ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |              ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |              ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |  |              ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |              ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |  |              ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |              ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |  |              ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |              ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |              ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: (kk1)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |  |              ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |  |              ]
|  |  |  |  |  |  |  |
|  |  |  |  |  |  |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     ]
|  |  |  |  |  |  |     |
|  |  |  |  |  |  |     +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  ]
|  |  |  |  |  |  |     |  |
|  |  |  |  |  |  |     |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  ]
|  |  |  |  |  |  |     |  |  |
|  |  |  |  |  |  |     |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |  ]
|  |  |  |  |  |  |     |  |  |  |
|  |  |  |  |  |  |     |  |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |  |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |  |  ]
|  |  |  |  |  |  |     |  |  |  |
|  |  |  |  |  |  |     |  |  |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |     ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |     ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |     ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |     ]
|  |  |  |  |  |  |     |  |  |
|  |  |  |  |  |  |     |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |  ]
|  |  |  |  |  |  |     |  |  |  |
|  |  |  |  |  |  |     |  |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |  |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |  |  ]
|  |  |  |  |  |  |     |  |  |  |
|  |  |  |  |  |  |     |  |  |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |     ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |     ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |     ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |     ]
|  |  |  |  |  |  |     |  |  |
|  |  |  |  |  |  |     |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |  ]
|  |  |  |  |  |  |     |  |  |  |
|  |  |  |  |  |  |     |  |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |  |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |  |  ]
|  |  |  |  |  |  |     |  |  |  |
|  |  |  |  |  |  |     |  |  |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |     ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |     ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |     ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |     ]
|  |  |  |  |  |  |     |  |  |
|  |  |  |  |  |  |     |  |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |     ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |     ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |     ]
|  |  |  |  |  |  |     |  |     |
|  |  |  |  |  |  |     |  |     +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |     |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |     |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |     |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |     |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |     |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |     |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |     |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |     |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |     |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |     |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |     |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |     |  ]
|  |  |  |  |  |  |     |  |     |
|  |  |  |  |  |  |     |  |     `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |        ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |        ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |        ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |        ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |        ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |        ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |        ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |        ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |        ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |        ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |        ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |        ]
|  |  |  |  |  |  |     |  |
|  |  |  |  |  |  |     |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  ]
|  |  |  |  |  |  |     |  |  |
|  |  |  |  |  |  |     |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |  ]
|  |  |  |  |  |  |     |  |  |  |
|  |  |  |  |  |  |     |  |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |  |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |  |  ]
|  |  |  |  |  |  |     |  |  |  |
|  |  |  |  |  |  |     |  |  |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |     ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |     ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |     ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |     ]
|  |  |  |  |  |  |     |  |  |
|  |  |  |  |  |  |     |  |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |     ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |     ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk2)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |     ]
|  |  |  |  |  |  |     |  |     |
|  |  |  |  |  |  |     |  |     `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |        ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |        ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |        ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |        ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |        ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |        ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |        ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |        ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |        ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |        ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk2)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |        ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |        ]
|  |  |  |  |  |  |     |  |
|  |  |  |  |  |  |     |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |     ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk2)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |     ]
|  |  |  |  |  |  |     |     |
|  |  |  |  |  |  |     |     +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |     |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |     |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |     |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |     |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |     |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |     |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |     |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |     |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |     |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk2)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |     |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |     |     |  ]
|  |  |  |  |  |  |     |     |  |
|  |  |  |  |  |  |     |     |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |     |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |     |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |     |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |     |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |     |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |     |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |     |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |     |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |     |  |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk2)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |     |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |     |     |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |     |  |  ]
|  |  |  |  |  |  |     |     |  |
|  |  |  |  |  |  |     |     |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |     |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |     |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |     |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |     |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |     |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |     |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |     |     ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |     |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |     |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk2)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |     |     ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |     |     |     ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |     |     |     ]
|  |  |  |  |  |  |     |     |
|  |  |  |  |  |  |     |     `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |        ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |        ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |        ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |        ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |        ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |        ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |        ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |        ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |        ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk2)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |        ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |        ]
|  |  |  |  |  |  |     |        |
|  |  |  |  |  |  |     |        `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |           ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |           ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |           ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |           ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |           ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |           ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |           ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |           ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |           ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk2)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |           ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |           ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |     |           ]
|  |  |  |  |  |  |     |
|  |  |  |  |  |  |     +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  ]
|  |  |  |  |  |  |     |  |
|  |  |  |  |  |  |     |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  ]
|  |  |  |  |  |  |     |  |  |
|  |  |  |  |  |  |     |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |  ]
|  |  |  |  |  |  |     |  |  |  |
|  |  |  |  |  |  |     |  |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |  |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |  |  ]
|  |  |  |  |  |  |     |  |  |  |
|  |  |  |  |  |  |     |  |  |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |  |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |     ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |     ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |  |     ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |  |     ]
|  |  |  |  |  |  |     |  |  |
|  |  |  |  |  |  |     |  |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |     ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |     ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk2)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |     ]
|  |  |  |  |  |  |     |  |     |
|  |  |  |  |  |  |     |  |     `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |        ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |        ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |        ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |  |        ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |        ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |        ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |        ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |        ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |        ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |  |        ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk2)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |        ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |     |  |        ]
|  |  |  |  |  |  |     |  |
|  |  |  |  |  |  |     |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |     ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |     ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk2)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |     ]
|  |  |  |  |  |  |     |     |
|  |  |  |  |  |  |     |     `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |        ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |        ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |        ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |        ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |        ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |        ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |        ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |        ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |        ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk2)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |        ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |        ]
|  |  |  |  |  |  |     |        |
|  |  |  |  |  |  |     |        `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |           ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |           ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |           ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |     |           ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |           ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |     |           ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |           ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |           ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |           ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk2)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |     |           ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |     |           ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |     |           ]
|  |  |  |  |  |  |     |
|  |  |  |  |  |  |     `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |        ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |        ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |        ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |        ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |        ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |        ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |        ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |        ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk2)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |        ]
|  |  |  |  |  |  |        |
|  |  |  |  |  |  |        +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |        |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |        |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |        |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |        |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |        |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |        |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |        |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |        |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk2)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |        |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |        |  ]
|  |  |  |  |  |  |        |  |
|  |  |  |  |  |  |        |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |        |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |        |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |        |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |        |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |        |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |        |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |        |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |        |  |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk2)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |        |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |        |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |        |  |  ]
|  |  |  |  |  |  |        |  |  |
|  |  |  |  |  |  |        |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |        |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |        |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |        |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |        |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |        |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |        |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |        |  |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |        |  |  |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk2)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |        |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |        |  |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |        |  |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |        |  |  |  ]
|  |  |  |  |  |  |        |  |  |
|  |  |  |  |  |  |        |  |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |        |  |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |        |  |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |        |  |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |        |  |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |        |  |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |        |  |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |        |  |     ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |        |  |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk2)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |        |  |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |        |  |     ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |        |  |     ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |        |  |     ]
|  |  |  |  |  |  |        |  |
|  |  |  |  |  |  |        |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |        |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |        |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |        |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |        |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |        |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |        |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |        |     ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |        |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk2)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |        |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |        |     ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |        |     ]
|  |  |  |  |  |  |        |     |
|  |  |  |  |  |  |        |     `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |        |        ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |        |        ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |        |        ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |        |        ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |        |        ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |        |        ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |        |        ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |        |        ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk2)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |        |        ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |        |        ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |        |        ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |        |        ]
|  |  |  |  |  |  |        |
|  |  |  |  |  |  |        `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |           ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |           ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |           ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |           ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |           ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |           ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |           ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |           ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk2)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |           ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |           ]
|  |  |  |  |  |  |           |
|  |  |  |  |  |  |           `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |              ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |              ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |              ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |              ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |              ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |              ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |              ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |              ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk2)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |              ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |              ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |              ]
|  |  |  |  |  |  |              |
|  |  |  |  |  |  |              `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |                 ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |                 ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |  |                 ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |  |                 ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |                 ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |  |                 ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |                 ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |                 ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk2)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |                 ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |  |  |                 ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |  |  |                 ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |  |                 ]
|  |  |  |  |  |  |
|  |  |  |  |  |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |     ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk2)⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |  |     ]
|  |  |  |  |  |     |
|  |  |  |  |  |     +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |     |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |     |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |     |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |     |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |     |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |     |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk2)⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |  |     |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk3)⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |  |     |  ]
|  |  |  |  |  |     |  |
|  |  |  |  |  |     |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |     |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |     |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |     |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |     |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |     |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |     |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk2)⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |  |     |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk3)⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |  |     |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |  |     |  |  ]
|  |  |  |  |  |     |  |  |
|  |  |  |  |  |     |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |     |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |     |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |     |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |     |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |     |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |     |  |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk2)⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |  |     |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk3)⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |  |     |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |  |     |  |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk3,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |     |  |  |  ]
|  |  |  |  |  |     |  |  |  |
|  |  |  |  |  |     |  |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |     |  |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |     |  |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |     |  |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |     |  |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |     |  |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |     |  |  |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk2)⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |  |     |  |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk3)⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |  |     |  |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |  |     |  |  |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk3,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |     |  |  |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |  |     |  |  |  |  ]
|  |  |  |  |  |     |  |  |  |  |
|  |  |  |  |  |     |  |  |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |     |  |  |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |     |  |  |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |     |  |  |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |     |  |  |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |     |  |  |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |     |  |  |  |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk2)⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |  |     |  |  |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk3)⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |  |     |  |  |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |  |     |  |  |  |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk3,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |     |  |  |  |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |  |     |  |  |  |  |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk3,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |  |     |  |  |  |  |  ]
|  |  |  |  |  |     |  |  |  |  |
|  |  |  |  |  |     |  |  |  |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |     |  |  |  |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |     |  |  |  |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |     |  |  |  |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |     |  |  |  |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |     |  |  |  |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |     |  |  |  |     ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk2)⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |  |     |  |  |  |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk3)⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |  |     |  |  |  |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |  |     |  |  |  |     ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk3,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |     |  |  |  |     ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |  |     |  |  |  |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk3,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |     |  |  |  |     ]
|  |  |  |  |  |     |  |  |  |
|  |  |  |  |  |     |  |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |     |  |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |     |  |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |     |  |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |     |  |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |     |  |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |     |  |  |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk2)⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |  |     |  |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk3)⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |  |     |  |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |  |     |  |  |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk3,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |     |  |  |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |     |  |  |  |  ]
|  |  |  |  |  |     |  |  |  |  |
|  |  |  |  |  |     |  |  |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |     |  |  |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |     |  |  |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |     |  |  |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |     |  |  |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |     |  |  |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |     |  |  |  |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk2)⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |  |     |  |  |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk3)⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |  |     |  |  |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |  |     |  |  |  |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk3,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |     |  |  |  |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |     |  |  |  |  |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk3,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |  |     |  |  |  |  |  ]
|  |  |  |  |  |     |  |  |  |  |
|  |  |  |  |  |     |  |  |  |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |     |  |  |  |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |     |  |  |  |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |     |  |  |  |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |     |  |  |  |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |     |  |  |  |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |     |  |  |  |     ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk2)⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |  |     |  |  |  |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk3)⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |  |     |  |  |  |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |  |     |  |  |  |     ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk3,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |     |  |  |  |     ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |     |  |  |  |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk3,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |     |  |  |  |     ]
|  |  |  |  |  |     |  |  |  |
|  |  |  |  |  |     |  |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |     |  |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |     |  |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |     |  |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |     |  |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |     |  |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |     |  |  |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk2)⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |  |     |  |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk3)⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |  |     |  |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |  |     |  |  |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk3,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |     |  |  |  |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk3,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |  |     |  |  |  |  ]
|  |  |  |  |  |     |  |  |  |  |
|  |  |  |  |  |     |  |  |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |     |  |  |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |     |  |  |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |     |  |  |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |     |  |  |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |     |  |  |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |     |  |  |  |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk2)⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |  |     |  |  |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk3)⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |  |     |  |  |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |  |     |  |  |  |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk3,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |     |  |  |  |  |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk3,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |  |     |  |  |  |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |  |     |  |  |  |  |  ]
|  |  |  |  |  |     |  |  |  |  |
|  |  |  |  |  |     |  |  |  |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |     |  |  |  |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |     |  |  |  |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |     |  |  |  |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |     |  |  |  |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |     |  |  |  |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |     |  |  |  |     ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk2)⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |  |     |  |  |  |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk3)⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |  |     |  |  |  |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |  |     |  |  |  |     ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk3,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |     |  |  |  |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk3,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |  |     |  |  |  |     ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |     |  |  |  |     ]
|  |  |  |  |  |     |  |  |  |
|  |  |  |  |  |     |  |  |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |     |  |  |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |     |  |  |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |     |  |  |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |     |  |  |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |     |  |  |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |     |  |  |     ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk2)⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |  |     |  |  |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk3)⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |  |     |  |  |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |  |     |  |  |     ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk3,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |     |  |  |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk3,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |     |  |  |     ]
|  |  |  |  |  |     |  |  |     |
|  |  |  |  |  |     |  |  |     +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |     |  |  |     |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |     |  |  |     |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |     |  |  |     |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |     |  |  |     |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |     |  |  |     |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |     |  |  |     |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk2)⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |  |     |  |  |     |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk3)⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |  |     |  |  |     |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |  |     |  |  |     |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk3,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |     |  |  |     |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk3,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |     |  |  |     |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |  |     |  |  |     |  ]
|  |  |  |  |  |     |  |  |     |
|  |  |  |  |  |     |  |  |     `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |     |  |  |        ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |     |  |  |        ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |     |  |  |        ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |     |  |  |        ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |     |  |  |        ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |     |  |  |        ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk2)⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |  |     |  |  |        ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk3)⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |  |     |  |  |        ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |  |     |  |  |        ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk3,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |     |  |  |        ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk3,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |     |  |  |        ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |     |  |  |        ]
|  |  |  |  |  |     |  |  |
|  |  |  |  |  |     |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |     |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |     |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |     |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |     |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |     |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |     |  |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk2)⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |  |     |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk3)⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |  |     |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |  |     |  |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |  |     |  |  |  ]
|  |  |  |  |  |     |  |  |  |
|  |  |  |  |  |     |  |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |     |  |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |     |  |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |     |  |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |     |  |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |     |  |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |     |  |  |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk2)⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |  |     |  |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk3)⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |  |     |  |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |  |     |  |  |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |  |     |  |  |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk3,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |     |  |  |  |  ]
|  |  |  |  |  |     |  |  |  |  |
|  |  |  |  |  |     |  |  |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |     |  |  |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |     |  |  |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |     |  |  |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |     |  |  |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |     |  |  |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |     |  |  |  |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk2)⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |  |     |  |  |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk3)⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |  |     |  |  |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |  |     |  |  |  |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |  |     |  |  |  |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk3,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |     |  |  |  |  |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk3,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |  |     |  |  |  |  |  ]
|  |  |  |  |  |     |  |  |  |  |
|  |  |  |  |  |     |  |  |  |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |     |  |  |  |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |     |  |  |  |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |     |  |  |  |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |     |  |  |  |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |     |  |  |  |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |     |  |  |  |     ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk2)⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |  |     |  |  |  |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk3)⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |  |     |  |  |  |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |  |     |  |  |  |     ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |  |     |  |  |  |     ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk3,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |     |  |  |  |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk3,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |     |  |  |  |     ]
|  |  |  |  |  |     |  |  |  |
|  |  |  |  |  |     |  |  |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |     |  |  |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |     |  |  |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |     |  |  |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |     |  |  |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |     |  |  |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |     |  |  |     ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk2)⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |  |     |  |  |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk3)⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |  |     |  |  |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |  |     |  |  |     ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |  |     |  |  |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk3)⟨kk3,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |  |     |  |  |     ]
|  |  |  |  |  |     |  |  |     |
|  |  |  |  |  |     |  |  |     `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |     |  |  |        ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |     |  |  |        ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |     |  |  |        ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |     |  |  |        ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |     |  |  |        ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |     |  |  |        ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk2)⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |  |     |  |  |        ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk3)⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |  |     |  |  |        ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |  |     |  |  |        ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |  |     |  |  |        ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk3)⟨kk3,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |  |     |  |  |        ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk3,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |     |  |  |        ]
|  |  |  |  |  |     |  |  |
|  |  |  |  |  |     |  |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |     |  |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |     |  |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |     |  |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |     |  |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |     |  |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |     |  |     ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk2)⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |  |     |  |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk3)⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |  |     |  |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |  |     |  |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk3)⟨kk3,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |  |     |  |     ]
|  |  |  |  |  |     |  |     |
|  |  |  |  |  |     |  |     +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |     |  |     |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |     |  |     |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |     |  |     |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |     |  |     |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |     |  |     |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |     |  |     |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk2)⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |  |     |  |     |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk3)⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |  |     |  |     |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |  |     |  |     |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk3)⟨kk3,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |  |     |  |     |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk3,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |     |  |     |  ]
|  |  |  |  |  |     |  |     |  |
|  |  |  |  |  |     |  |     |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |     |  |     |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |     |  |     |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |     |  |     |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |     |  |     |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |     |  |     |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |     |  |     |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk2)⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |  |     |  |     |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk3)⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |  |     |  |     |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |  |     |  |     |  |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk3)⟨kk3,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |  |     |  |     |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk3,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |     |  |     |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |  |     |  |     |  |  ]
|  |  |  |  |  |     |  |     |  |
|  |  |  |  |  |     |  |     |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |     |  |     |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |     |  |     |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |     |  |     |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |     |  |     |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |     |  |     |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |     |  |     |     ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk2)⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |  |     |  |     |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk3)⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |  |     |  |     |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |  |     |  |     |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk3)⟨kk3,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |  |     |  |     |     ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk3,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |     |  |     |     ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |     |  |     |     ]
|  |  |  |  |  |     |  |     |
|  |  |  |  |  |     |  |     `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |     |  |        ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |     |  |        ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |     |  |        ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |     |  |        ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |     |  |        ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |     |  |        ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk2)⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |  |     |  |        ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk3)⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |  |     |  |        ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |  |     |  |        ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk3)⟨kk3,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |  |     |  |        ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |  |     |  |        ]
|  |  |  |  |  |     |  |        |
|  |  |  |  |  |     |  |        `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |     |  |           ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |     |  |           ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |     |  |           ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |     |  |           ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |     |  |           ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |     |  |           ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk2)⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |  |     |  |           ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk3)⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |  |     |  |           ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |  |     |  |           ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk3)⟨kk3,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |  |     |  |           ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |  |     |  |           ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk3,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |     |  |           ]
|  |  |  |  |  |     |  |
|  |  |  |  |  |     |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |     |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |     |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |     |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |     |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |     |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |     |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk2)⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |  |     |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk3)⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |  |     |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |  |     |  |  ]
|  |  |  |  |  |     |  |  |
|  |  |  |  |  |     |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |     |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |     |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |     |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |     |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |     |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |     |  |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk2)⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |  |     |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk3)⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |  |     |  |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |  |     |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |  |     |  |  |  ]
|  |  |  |  |  |     |  |  |  |
|  |  |  |  |  |     |  |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |     |  |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |     |  |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |     |  |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |     |  |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |     |  |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |     |  |  |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk2)⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |  |     |  |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk3)⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |  |     |  |  |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |  |     |  |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |  |     |  |  |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk3,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |     |  |  |  |  ]
|  |  |  |  |  |     |  |  |  |  |
|  |  |  |  |  |     |  |  |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |     |  |  |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |     |  |  |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |     |  |  |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |     |  |  |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |     |  |  |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |     |  |  |  |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk2)⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |  |     |  |  |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk3)⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |  |     |  |  |  |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |  |     |  |  |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |  |     |  |  |  |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk3,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |     |  |  |  |  |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk3,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |  |     |  |  |  |  |  ]
|  |  |  |  |  |     |  |  |  |  |
|  |  |  |  |  |     |  |  |  |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |     |  |  |  |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |     |  |  |  |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |     |  |  |  |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |     |  |  |  |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |     |  |  |  |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |     |  |  |  |     ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk2)⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |  |     |  |  |  |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk3)⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |  |     |  |  |  |     ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |  |     |  |  |  |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |  |     |  |  |  |     ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk3,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |     |  |  |  |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk3,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |     |  |  |  |     ]
|  |  |  |  |  |     |  |  |  |
|  |  |  |  |  |     |  |  |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |     |  |  |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |     |  |  |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |     |  |  |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |     |  |  |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |     |  |  |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |     |  |  |     ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk2)⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |  |     |  |  |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk3)⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |  |     |  |  |     ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |  |     |  |  |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |  |     |  |  |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk3)⟨kk3,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |  |     |  |  |     ]
|  |  |  |  |  |     |  |  |     |
|  |  |  |  |  |     |  |  |     `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |     |  |  |        ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |     |  |  |        ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |     |  |  |        ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |     |  |  |        ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |     |  |  |        ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |     |  |  |        ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk2)⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |  |     |  |  |        ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk3)⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |  |     |  |  |        ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |  |     |  |  |        ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |  |     |  |  |        ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk3)⟨kk3,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |  |     |  |  |        ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk3,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |     |  |  |        ]
|  |  |  |  |  |     |  |  |
|  |  |  |  |  |     |  |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |     |  |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |     |  |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |     |  |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |     |  |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |     |  |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |     |  |     ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk2)⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |  |     |  |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk3)⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |  |     |  |     ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |  |     |  |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk3)⟨kk3,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |  |     |  |     ]
|  |  |  |  |  |     |  |     |
|  |  |  |  |  |     |  |     `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |     |  |        ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |     |  |        ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |     |  |        ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |     |  |        ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |     |  |        ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |     |  |        ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk2)⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |  |     |  |        ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk3)⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |  |     |  |        ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |  |     |  |        ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk3)⟨kk3,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |  |     |  |        ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |  |     |  |        ]
|  |  |  |  |  |     |  |        |
|  |  |  |  |  |     |  |        `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |     |  |           ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |     |  |           ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |     |  |           ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |     |  |           ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |     |  |           ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |     |  |           ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk2)⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |  |     |  |           ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk3)⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |  |     |  |           ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |  |     |  |           ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk3)⟨kk3,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |  |     |  |           ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |  |     |  |           ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk3,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |     |  |           ]
|  |  |  |  |  |     |  |
|  |  |  |  |  |     |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |     |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |     |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |     |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |     |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |     |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |     |     ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk2)⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |  |     |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk3)⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |  |     |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk3)⟨kk3,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |  |     |     ]
|  |  |  |  |  |     |     |
|  |  |  |  |  |     |     +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |     |     |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |     |     |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |     |     |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |     |     |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |     |     |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |     |     |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk2)⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |  |     |     |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk3)⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |  |     |     |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk3)⟨kk3,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |  |     |     |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |  |     |     |  ]
|  |  |  |  |  |     |     |  |
|  |  |  |  |  |     |     |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |     |     |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |     |     |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |     |     |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |     |     |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |     |     |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |     |     |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk2)⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |  |     |     |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk3)⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |  |     |     |  |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk3)⟨kk3,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |  |     |     |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |  |     |     |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk3,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |     |     |  |  ]
|  |  |  |  |  |     |     |  |  |
|  |  |  |  |  |     |     |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |     |     |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |     |     |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |     |     |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |     |     |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |     |     |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |     |     |  |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk2)⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |  |     |     |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk3)⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |  |     |     |  |  |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk3)⟨kk3,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |  |     |     |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |  |     |     |  |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk3,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |     |     |  |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |  |     |     |  |  |  ]
|  |  |  |  |  |     |     |  |  |
|  |  |  |  |  |     |     |  |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |     |     |  |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |     |     |  |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |     |     |  |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |     |     |  |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |     |     |  |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |     |     |  |     ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk2)⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |  |     |     |  |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk3)⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |  |     |     |  |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk3)⟨kk3,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |  |     |     |  |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |  |     |     |  |     ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk3,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |     |     |  |     ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |     |     |  |     ]
|  |  |  |  |  |     |     |  |
|  |  |  |  |  |     |     |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |     |     |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |     |     |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |     |     |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |     |     |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |     |     |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |     |     |     ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk2)⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |  |     |     |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk3)⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |  |     |     |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk3)⟨kk3,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |  |     |     |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |  |     |     |     ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |  |     |     |     ]
|  |  |  |  |  |     |     |     |
|  |  |  |  |  |     |     |     `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |     |     |        ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |     |     |        ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |     |     |        ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |     |     |        ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |     |     |        ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |     |     |        ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk2)⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |  |     |     |        ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk3)⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |  |     |     |        ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk3)⟨kk3,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |  |     |     |        ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |  |     |     |        ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |  |     |     |        ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk3,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |     |     |        ]
|  |  |  |  |  |     |     |
|  |  |  |  |  |     |     `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |     |        ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |     |        ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |     |        ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |     |        ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |     |        ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |     |        ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk2)⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |  |     |        ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk3)⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |  |     |        ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk3)⟨kk3,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |  |     |        ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |  |     |        ]
|  |  |  |  |  |     |        |
|  |  |  |  |  |     |        `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |     |           ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |     |           ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |     |           ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |     |           ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |     |           ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |     |           ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk2)⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |  |     |           ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk3)⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |  |     |           ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk3)⟨kk3,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |  |     |           ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |  |     |           ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |  |     |           ]
|  |  |  |  |  |     |           |
|  |  |  |  |  |     |           `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |     |              ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |     |              ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |     |              ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |     |              ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |     |              ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |     |              ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk2)⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |  |     |              ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk3)⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |  |     |              ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk3)⟨kk3,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |  |     |              ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |  |     |              ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |  |     |              ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk3,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |     |              ]
|  |  |  |  |  |     |
|  |  |  |  |  |     `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |        ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |        ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |        ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |        ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |        ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |        ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk2)⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |  |        ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |  |        ]
|  |  |  |  |  |        |
|  |  |  |  |  |        `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |           ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |           ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |           ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |           ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |           ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |           ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk2)⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |  |           ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |  |           ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk3)⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |  |           ]
|  |  |  |  |  |           |
|  |  |  |  |  |           +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |           |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |           |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |           |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |           |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |           |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |           |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk2)⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |  |           |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |  |           |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk3)⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |  |           |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |  |           |  ]
|  |  |  |  |  |           |  |
|  |  |  |  |  |           |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |           |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |           |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |           |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |           |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |           |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |           |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk2)⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |  |           |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |  |           |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk3)⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |  |           |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |  |           |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk3,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |           |  |  ]
|  |  |  |  |  |           |  |  |
|  |  |  |  |  |           |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |           |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |           |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |           |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |           |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |           |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |           |  |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk2)⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |  |           |  |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |  |           |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk3)⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |  |           |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |  |           |  |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk3,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |           |  |  |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk3,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |  |           |  |  |  ]
|  |  |  |  |  |           |  |  |
|  |  |  |  |  |           |  |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |           |  |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |           |  |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |           |  |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |           |  |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |           |  |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |           |  |     ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk2)⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |  |           |  |     ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |  |           |  |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk3)⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |  |           |  |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |  |           |  |     ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk3,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |           |  |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk3,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |           |  |     ]
|  |  |  |  |  |           |  |
|  |  |  |  |  |           |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |           |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |           |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |           |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |           |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |           |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |           |     ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk2)⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |  |           |     ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |  |           |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk3)⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |  |           |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |  |           |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk3)⟨kk3,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |  |           |     ]
|  |  |  |  |  |           |     |
|  |  |  |  |  |           |     `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |           |        ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |           |        ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |           |        ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |           |        ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |           |        ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |           |        ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk2)⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |  |           |        ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |  |           |        ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk3)⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |  |           |        ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |  |           |        ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk3)⟨kk3,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |  |           |        ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk3,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |           |        ]
|  |  |  |  |  |           |
|  |  |  |  |  |           `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |              ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |              ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |              ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |              ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |              ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |              ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk2)⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |  |              ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |  |              ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk3)⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |  |              ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk3)⟨kk3,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |  |              ]
|  |  |  |  |  |              |
|  |  |  |  |  |              `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |                 ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |                 ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |                 ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |                 ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |                 ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |                 ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk2)⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |  |                 ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |  |                 ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk3)⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |  |                 ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk3)⟨kk3,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |  |                 ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |  |                 ]
|  |  |  |  |  |                 |
|  |  |  |  |  |                 `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |                    ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |                    ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |  |                    ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |  |                    ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |                    ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |  |                    ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk2)⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |  |                    ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |  |                    ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk3)⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |  |                    ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk3)⟨kk3,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |  |                    ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |  |                    ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk3,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |  |                    ]
|  |  |  |  |  |
|  |  |  |  |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     ]
|  |  |  |  |     |
|  |  |  |  |     +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |  ]
|  |  |  |  |     |  |
|  |  |  |  |     |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |  |  ]
|  |  |  |  |     |  |  |
|  |  |  |  |     |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |  |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |  |  |  ]
|  |  |  |  |     |  |  |  |
|  |  |  |  |     |  |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |  |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |  |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |  |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |  |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |  |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |  |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |  |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |  |  |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |  |  |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |     |  |  |  |  ]
|  |  |  |  |     |  |  |  |  |
|  |  |  |  |     |  |  |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |  |  |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |  |  |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |  |  |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |  |  |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |  |  |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |  |  |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |  |  |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |  |  |  |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |  |  |  |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |     |  |  |  |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |  |  |  |  |  ]
|  |  |  |  |     |  |  |  |  |  |
|  |  |  |  |     |  |  |  |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |  |  |  |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |  |  |  |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |  |  |  |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |  |  |  |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |  |  |  |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |  |  |  |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |  |  |  |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |  |  |  |  |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |  |  |  |  |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |     |  |  |  |  |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |  |  |  |  |  |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |  |  |  |  |  |  ]
|  |  |  |  |     |  |  |  |  |  |
|  |  |  |  |     |  |  |  |  |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |  |  |  |  |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |  |  |  |  |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |  |  |  |  |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |  |  |  |  |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |  |  |  |  |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |  |  |  |  |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |  |  |  |  |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |  |  |  |  |     ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |  |  |  |  |     ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |     |  |  |  |  |     ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |  |  |  |  |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |     |  |  |  |  |     ]
|  |  |  |  |     |  |  |  |  |
|  |  |  |  |     |  |  |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |  |  |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |  |  |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |  |  |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |  |  |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |  |  |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |  |  |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |  |  |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |  |  |  |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |  |  |  |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |     |  |  |  |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |     |  |  |  |  |  ]
|  |  |  |  |     |  |  |  |  |  |
|  |  |  |  |     |  |  |  |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |  |  |  |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |  |  |  |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |  |  |  |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |  |  |  |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |  |  |  |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |  |  |  |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |  |  |  |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |  |  |  |  |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |  |  |  |  |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |     |  |  |  |  |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |     |  |  |  |  |  |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |  |  |  |  |  |  ]
|  |  |  |  |     |  |  |  |  |  |
|  |  |  |  |     |  |  |  |  |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |  |  |  |  |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |  |  |  |  |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |  |  |  |  |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |  |  |  |  |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |  |  |  |  |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |  |  |  |  |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |  |  |  |  |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |  |  |  |  |     ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |  |  |  |  |     ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |     |  |  |  |  |     ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |     |  |  |  |  |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |     |  |  |  |  |     ]
|  |  |  |  |     |  |  |  |  |
|  |  |  |  |     |  |  |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |  |  |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |  |  |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |  |  |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |  |  |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |  |  |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |  |  |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |  |  |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |  |  |  |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |  |  |  |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |     |  |  |  |  |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |  |  |  |  |  ]
|  |  |  |  |     |  |  |  |  |  |
|  |  |  |  |     |  |  |  |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |  |  |  |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |  |  |  |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |  |  |  |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |  |  |  |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |  |  |  |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |  |  |  |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |  |  |  |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |  |  |  |  |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |  |  |  |  |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |     |  |  |  |  |  |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |  |  |  |  |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |  |  |  |  |  |  ]
|  |  |  |  |     |  |  |  |  |  |
|  |  |  |  |     |  |  |  |  |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |  |  |  |  |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |  |  |  |  |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |  |  |  |  |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |  |  |  |  |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |  |  |  |  |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |  |  |  |  |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |  |  |  |  |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |  |  |  |  |     ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |  |  |  |  |     ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |     |  |  |  |  |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |  |  |  |  |     ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |     |  |  |  |  |     ]
|  |  |  |  |     |  |  |  |  |
|  |  |  |  |     |  |  |  |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |  |  |  |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |  |  |  |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |  |  |  |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |  |  |  |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |  |  |  |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |  |  |  |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |  |  |  |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |  |  |  |     ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |  |  |  |     ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |     |  |  |  |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |     |  |  |  |     ]
|  |  |  |  |     |  |  |  |     |
|  |  |  |  |     |  |  |  |     +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |  |  |  |     |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |  |  |  |     |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |  |  |  |     |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |  |  |  |     |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |  |  |  |     |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |  |  |  |     |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |  |  |  |     |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |  |  |  |     |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |  |  |  |     |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |     |  |  |  |     |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |     |  |  |  |     |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |  |  |  |     |  ]
|  |  |  |  |     |  |  |  |     |
|  |  |  |  |     |  |  |  |     `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |  |  |  |        ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |  |  |  |        ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |  |  |  |        ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |  |  |  |        ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |  |  |  |        ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |  |  |  |        ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |  |  |  |        ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |  |  |  |        ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |  |  |  |        ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |     |  |  |  |        ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |     |  |  |  |        ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |     |  |  |  |        ]
|  |  |  |  |     |  |  |  |
|  |  |  |  |     |  |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |  |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |  |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |  |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |  |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |  |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |  |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |  |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |  |  |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |  |  |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: (kk1)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |  |  |  |  ]
|  |  |  |  |     |  |  |  |  |
|  |  |  |  |     |  |  |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |  |  |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |  |  |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |  |  |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |  |  |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |  |  |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |  |  |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |  |  |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |  |  |  |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |  |  |  |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: (kk1)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |  |  |  |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |     |  |  |  |  |  ]
|  |  |  |  |     |  |  |  |  |  |
|  |  |  |  |     |  |  |  |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |  |  |  |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |  |  |  |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |  |  |  |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |  |  |  |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |  |  |  |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |  |  |  |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |  |  |  |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |  |  |  |  |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |  |  |  |  |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: (kk1)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |  |  |  |  |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |     |  |  |  |  |  |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |  |  |  |  |  |  ]
|  |  |  |  |     |  |  |  |  |  |
|  |  |  |  |     |  |  |  |  |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |  |  |  |  |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |  |  |  |  |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |  |  |  |  |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |  |  |  |  |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |  |  |  |  |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |  |  |  |  |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |  |  |  |  |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |  |  |  |  |     ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |  |  |  |  |     ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: (kk1)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |  |  |  |  |     ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |     |  |  |  |  |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |     |  |  |  |  |     ]
|  |  |  |  |     |  |  |  |  |
|  |  |  |  |     |  |  |  |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |  |  |  |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |  |  |  |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |  |  |  |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |  |  |  |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |  |  |  |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |  |  |  |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |  |  |  |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |  |  |  |     ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |  |  |  |     ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: (kk1)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |  |  |  |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |  |  |  |     ]
|  |  |  |  |     |  |  |  |     |
|  |  |  |  |     |  |  |  |     `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |  |  |  |        ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |  |  |  |        ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |  |  |  |        ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |  |  |  |        ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |  |  |  |        ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |  |  |  |        ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |  |  |  |        ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |  |  |  |        ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |  |  |  |        ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: (kk1)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |  |  |  |        ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |  |  |  |        ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |     |  |  |  |        ]
|  |  |  |  |     |  |  |  |
|  |  |  |  |     |  |  |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |  |  |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |  |  |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |  |  |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |  |  |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |  |  |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |  |  |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |  |  |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |  |  |     ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |  |  |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |  |  |     ]
|  |  |  |  |     |  |  |     |
|  |  |  |  |     |  |  |     +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |  |  |     |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |  |  |     |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |  |  |     |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |  |  |     |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |  |  |     |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |  |  |     |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |  |  |     |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |  |  |     |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |  |  |     |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |  |  |     |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |     |  |  |     |  ]
|  |  |  |  |     |  |  |     |  |
|  |  |  |  |     |  |  |     |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |  |  |     |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |  |  |     |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |  |  |     |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |  |  |     |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |  |  |     |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |  |  |     |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |  |  |     |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |  |  |     |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |  |  |     |  |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |  |  |     |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |     |  |  |     |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |  |  |     |  |  ]
|  |  |  |  |     |  |  |     |  |
|  |  |  |  |     |  |  |     |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |  |  |     |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |  |  |     |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |  |  |     |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |  |  |     |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |  |  |     |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |  |  |     |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |  |  |     |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |  |  |     |     ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |  |  |     |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |  |  |     |     ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |     |  |  |     |     ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |     |  |  |     |     ]
|  |  |  |  |     |  |  |     |
|  |  |  |  |     |  |  |     `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |  |  |        ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |  |  |        ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |  |  |        ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |  |  |        ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |  |  |        ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |  |  |        ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |  |  |        ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |  |  |        ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |  |  |        ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |  |  |        ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: (kk1)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |  |  |        ]
|  |  |  |  |     |  |  |        |
|  |  |  |  |     |  |  |        `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |  |  |           ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |  |  |           ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |  |  |           ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |  |  |           ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |  |  |           ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |  |  |           ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |  |  |           ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |  |  |           ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |  |  |           ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |  |  |           ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: (kk1)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |  |  |           ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |     |  |  |           ]
|  |  |  |  |     |  |  |
|  |  |  |  |     |  |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |  |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |  |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |  |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |  |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |  |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |  |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |  |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |  |     ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |  |     ]
|  |  |  |  |     |  |     |
|  |  |  |  |     |  |     +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |  |     |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |  |     |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |  |     |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |  |     |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |  |     |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |  |     |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |  |     |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |  |     |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |  |     |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |     |  |     |  ]
|  |  |  |  |     |  |     |  |
|  |  |  |  |     |  |     |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |  |     |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |  |     |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |  |     |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |  |     |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |  |     |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |  |     |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |  |     |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |  |     |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |  |     |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |     |  |     |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |  |     |  |  ]
|  |  |  |  |     |  |     |  |  |
|  |  |  |  |     |  |     |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |  |     |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |  |     |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |  |     |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |  |     |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |  |     |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |  |     |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |  |     |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |  |     |  |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |  |     |  |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |     |  |     |  |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |  |     |  |  |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |  |     |  |  |  ]
|  |  |  |  |     |  |     |  |  |
|  |  |  |  |     |  |     |  |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |  |     |  |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |  |     |  |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |  |     |  |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |  |     |  |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |  |     |  |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |  |     |  |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |  |     |  |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |  |     |  |     ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |  |     |  |     ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |     |  |     |  |     ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |  |     |  |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |     |  |     |  |     ]
|  |  |  |  |     |  |     |  |
|  |  |  |  |     |  |     |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |  |     |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |  |     |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |  |     |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |  |     |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |  |     |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |  |     |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |  |     |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |  |     |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |  |     |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |     |  |     |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |     |  |     |  |  ]
|  |  |  |  |     |  |     |  |  |
|  |  |  |  |     |  |     |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |  |     |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |  |     |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |  |     |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |  |     |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |  |     |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |  |     |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |  |     |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |  |     |  |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |  |     |  |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |     |  |     |  |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |     |  |     |  |  |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |  |     |  |  |  ]
|  |  |  |  |     |  |     |  |  |
|  |  |  |  |     |  |     |  |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |  |     |  |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |  |     |  |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |  |     |  |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |  |     |  |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |  |     |  |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |  |     |  |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |  |     |  |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |  |     |  |     ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |  |     |  |     ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |     |  |     |  |     ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |     |  |     |  |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |     |  |     |  |     ]
|  |  |  |  |     |  |     |  |
|  |  |  |  |     |  |     |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |  |     |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |  |     |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |  |     |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |  |     |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |  |     |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |  |     |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |  |     |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |  |     |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |  |     |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |     |  |     |  |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |  |     |  |  ]
|  |  |  |  |     |  |     |  |  |
|  |  |  |  |     |  |     |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |  |     |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |  |     |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |  |     |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |  |     |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |  |     |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |  |     |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |  |     |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |  |     |  |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |  |     |  |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |     |  |     |  |  |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |  |     |  |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |  |     |  |  |  ]
|  |  |  |  |     |  |     |  |  |
|  |  |  |  |     |  |     |  |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |  |     |  |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |  |     |  |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |  |     |  |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |  |     |  |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |  |     |  |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |  |     |  |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |  |     |  |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |  |     |  |     ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |  |     |  |     ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |     |  |     |  |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |  |     |  |     ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |     |  |     |  |     ]
|  |  |  |  |     |  |     |  |
|  |  |  |  |     |  |     |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |  |     |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |  |     |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |  |     |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |  |     |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |  |     |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |  |     |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |  |     |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |  |     |     ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |  |     |     ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |     |  |     |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |     |  |     |     ]
|  |  |  |  |     |  |     |     |
|  |  |  |  |     |  |     |     +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |  |     |     |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |  |     |     |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |  |     |     |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |  |     |     |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |  |     |     |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |  |     |     |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |  |     |     |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |  |     |     |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |  |     |     |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |     |  |     |     |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |     |  |     |     |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |  |     |     |  ]
|  |  |  |  |     |  |     |     |
|  |  |  |  |     |  |     |     `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |  |     |        ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |  |     |        ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |  |     |        ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |  |     |        ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |  |     |        ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |  |     |        ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |  |     |        ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |  |     |        ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |  |     |        ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |     |  |     |        ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |     |  |     |        ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |     |  |     |        ]
|  |  |  |  |     |  |     |
|  |  |  |  |     |  |     +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |  |     |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |  |     |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |  |     |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |  |     |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |  |     |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |  |     |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |  |     |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |  |     |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |  |     |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |  |     |  ]
|  |  |  |  |     |  |     |  |
|  |  |  |  |     |  |     |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |  |     |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |  |     |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |  |     |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |  |     |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |  |     |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |  |     |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |  |     |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |  |     |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |  |     |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |  |     |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |     |  |     |  |  ]
|  |  |  |  |     |  |     |  |  |
|  |  |  |  |     |  |     |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |  |     |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |  |     |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |  |     |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |  |     |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |  |     |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |  |     |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |  |     |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |  |     |  |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |  |     |  |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |  |     |  |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |     |  |     |  |  |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |  |     |  |  |  ]
|  |  |  |  |     |  |     |  |  |
|  |  |  |  |     |  |     |  |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |  |     |  |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |  |     |  |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |  |     |  |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |  |     |  |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |  |     |  |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |  |     |  |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |  |     |  |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |  |     |  |     ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |  |     |  |     ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |  |     |  |     ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |     |  |     |  |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |     |  |     |  |     ]
|  |  |  |  |     |  |     |  |
|  |  |  |  |     |  |     |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |  |     |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |  |     |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |  |     |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |  |     |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |  |     |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |  |     |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |  |     |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |  |     |     ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |  |     |     ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |  |     |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk2)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |  |     |     ]
|  |  |  |  |     |  |     |     |
|  |  |  |  |     |  |     |     `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |  |     |        ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |  |     |        ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |  |     |        ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |  |     |        ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |  |     |        ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |  |     |        ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |  |     |        ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |  |     |        ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |  |     |        ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |  |     |        ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk2)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |  |     |        ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |     |  |     |        ]
|  |  |  |  |     |  |     |
|  |  |  |  |     |  |     `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |  |        ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |  |        ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |  |        ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |  |        ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |  |        ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |  |        ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |  |        ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |  |        ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |  |        ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk2)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |  |        ]
|  |  |  |  |     |  |        |
|  |  |  |  |     |  |        +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |  |        |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |  |        |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |  |        |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |  |        |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |  |        |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |  |        |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |  |        |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |  |        |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |  |        |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk2)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |  |        |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |     |  |        |  ]
|  |  |  |  |     |  |        |  |
|  |  |  |  |     |  |        |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |  |        |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |  |        |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |  |        |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |  |        |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |  |        |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |  |        |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |  |        |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |  |        |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |  |        |  |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk2)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |  |        |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |     |  |        |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |  |        |  |  ]
|  |  |  |  |     |  |        |  |
|  |  |  |  |     |  |        |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |  |        |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |  |        |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |  |        |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |  |        |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |  |        |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |  |        |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |  |        |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |  |        |     ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |  |        |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk2)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |  |        |     ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |     |  |        |     ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |     |  |        |     ]
|  |  |  |  |     |  |        |
|  |  |  |  |     |  |        `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |  |           ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |  |           ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |  |           ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |  |           ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |  |           ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |  |           ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |  |           ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |  |           ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |  |           ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk2)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |  |           ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |  |           ]
|  |  |  |  |     |  |           |
|  |  |  |  |     |  |           `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |  |              ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |  |              ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |  |              ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |  |              ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |  |              ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |  |              ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |  |              ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |  |              ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |  |              ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk2)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |  |              ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |  |              ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |     |  |              ]
|  |  |  |  |     |  |
|  |  |  |  |     |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |     ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |     ]
|  |  |  |  |     |     |
|  |  |  |  |     |     +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |     |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |     |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |     |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |     |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |     |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |     |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |     |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |     |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |     |  ]
|  |  |  |  |     |     |  |
|  |  |  |  |     |     |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |     |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |     |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |     |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |     |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |     |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |     |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |     |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |     |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |     |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |     |     |  |  ]
|  |  |  |  |     |     |  |  |
|  |  |  |  |     |     |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |     |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |     |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |     |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |     |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |     |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |     |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |     |  |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |     |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |     |  |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |     |     |  |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |     |  |  |  ]
|  |  |  |  |     |     |  |  |  |
|  |  |  |  |     |     |  |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |     |  |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |     |  |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |     |  |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |     |  |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |     |  |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |     |  |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |     |  |  |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |     |  |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |     |  |  |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |     |     |  |  |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |     |  |  |  |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |     |  |  |  |  ]
|  |  |  |  |     |     |  |  |  |
|  |  |  |  |     |     |  |  |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |     |  |  |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |     |  |  |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |     |  |  |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |     |  |  |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |     |  |  |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |     |  |  |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |     |  |  |     ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |     |  |  |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |     |  |  |     ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |     |     |  |  |     ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |     |  |  |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |     |     |  |  |     ]
|  |  |  |  |     |     |  |  |
|  |  |  |  |     |     |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |     |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |     |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |     |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |     |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |     |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |     |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |     |  |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |     |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |     |  |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |     |     |  |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |     |     |  |  |  ]
|  |  |  |  |     |     |  |  |  |
|  |  |  |  |     |     |  |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |     |  |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |     |  |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |     |  |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |     |  |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |     |  |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |     |  |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |     |  |  |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |     |  |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |     |  |  |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |     |     |  |  |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |     |     |  |  |  |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |     |  |  |  |  ]
|  |  |  |  |     |     |  |  |  |
|  |  |  |  |     |     |  |  |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |     |  |  |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |     |  |  |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |     |  |  |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |     |  |  |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |     |  |  |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |     |  |  |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |     |  |  |     ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |     |  |  |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |     |  |  |     ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |     |     |  |  |     ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |     |     |  |  |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |     |     |  |  |     ]
|  |  |  |  |     |     |  |  |
|  |  |  |  |     |     |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |     |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |     |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |     |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |     |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |     |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |     |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |     |  |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |     |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |     |  |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |     |     |  |  |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |     |  |  |  ]
|  |  |  |  |     |     |  |  |  |
|  |  |  |  |     |     |  |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |     |  |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |     |  |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |     |  |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |     |  |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |     |  |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |     |  |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |     |  |  |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |     |  |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |     |  |  |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |     |     |  |  |  |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |     |  |  |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |     |  |  |  |  ]
|  |  |  |  |     |     |  |  |  |
|  |  |  |  |     |     |  |  |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |     |  |  |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |     |  |  |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |     |  |  |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |     |  |  |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |     |  |  |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |     |  |  |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |     |  |  |     ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |     |  |  |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |     |  |  |     ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |     |     |  |  |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |     |  |  |     ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |     |     |  |  |     ]
|  |  |  |  |     |     |  |  |
|  |  |  |  |     |     |  |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |     |  |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |     |  |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |     |  |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |     |  |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |     |  |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |     |  |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |     |  |     ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |     |  |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |     |  |     ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |     |     |  |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |     |     |  |     ]
|  |  |  |  |     |     |  |     |
|  |  |  |  |     |     |  |     +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |     |  |     |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |     |  |     |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |     |  |     |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |     |  |     |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |     |  |     |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |     |  |     |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |     |  |     |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |     |  |     |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |     |  |     |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |     |     |  |     |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |     |     |  |     |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |     |  |     |  ]
|  |  |  |  |     |     |  |     |
|  |  |  |  |     |     |  |     `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |     |  |        ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |     |  |        ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |     |  |        ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |     |  |        ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |     |  |        ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |     |  |        ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |     |  |        ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |     |  |        ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |     |  |        ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |     |     |  |        ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |     |     |  |        ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |     |     |  |        ]
|  |  |  |  |     |     |  |
|  |  |  |  |     |     |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |     |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |     |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |     |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |     |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |     |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |     |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |     |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |     |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |     |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |     |  |  ]
|  |  |  |  |     |     |  |  |
|  |  |  |  |     |     |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |     |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |     |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |     |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |     |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |     |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |     |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |     |  |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |     |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |     |  |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |     |  |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |     |     |  |  |  ]
|  |  |  |  |     |     |  |  |  |
|  |  |  |  |     |     |  |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |     |  |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |     |  |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |     |  |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |     |  |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |     |  |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |     |  |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |     |  |  |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |     |  |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |     |  |  |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |     |  |  |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |     |     |  |  |  |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |     |  |  |  |  ]
|  |  |  |  |     |     |  |  |  |
|  |  |  |  |     |     |  |  |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |     |  |  |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |     |  |  |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |     |  |  |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |     |  |  |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |     |  |  |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |     |  |  |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |     |  |  |     ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |     |  |  |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |     |  |  |     ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |     |  |  |     ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |     |     |  |  |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |     |     |  |  |     ]
|  |  |  |  |     |     |  |  |
|  |  |  |  |     |     |  |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |     |  |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |     |  |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |     |  |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |     |  |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |     |  |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |     |  |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |     |  |     ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |     |  |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |     |  |     ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |     |  |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk2)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |     |  |     ]
|  |  |  |  |     |     |  |     |
|  |  |  |  |     |     |  |     `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |     |  |        ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |     |  |        ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |     |  |        ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |     |  |        ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |     |  |        ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |     |  |        ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |     |  |        ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |     |  |        ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |     |  |        ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |     |  |        ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk2)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |     |  |        ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |     |     |  |        ]
|  |  |  |  |     |     |  |
|  |  |  |  |     |     |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |     |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |     |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |     |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |     |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |     |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |     |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |     |     ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |     |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |     |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk2)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |     |     ]
|  |  |  |  |     |     |     |
|  |  |  |  |     |     |     +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |     |     |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |     |     |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |     |     |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |     |     |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |     |     |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |     |     |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |     |     |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |     |     |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |     |     |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk2)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |     |     |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |     |     |     |  ]
|  |  |  |  |     |     |     |  |
|  |  |  |  |     |     |     |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |     |     |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |     |     |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |     |     |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |     |     |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |     |     |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |     |     |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |     |     |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |     |     |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |     |     |  |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk2)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |     |     |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |     |     |     |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |     |     |  |  ]
|  |  |  |  |     |     |     |  |
|  |  |  |  |     |     |     |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |     |     |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |     |     |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |     |     |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |     |     |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |     |     |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |     |     |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |     |     |     ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |     |     |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |     |     |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk2)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |     |     |     ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |     |     |     |     ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |     |     |     |     ]
|  |  |  |  |     |     |     |
|  |  |  |  |     |     |     `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |     |        ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |     |        ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |     |        ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |     |        ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |     |        ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |     |        ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |     |        ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |     |        ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |     |        ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk2)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |     |        ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |     |        ]
|  |  |  |  |     |     |        |
|  |  |  |  |     |     |        `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |     |           ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |     |           ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |     |           ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |     |           ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |     |           ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |     |           ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |     |           ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |     |           ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |     |           ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk2)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |     |           ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |     |           ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |     |     |           ]
|  |  |  |  |     |     |
|  |  |  |  |     |     +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |     |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |     |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |     |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |     |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |     |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |     |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |     |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |     |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |     |  ]
|  |  |  |  |     |     |  |
|  |  |  |  |     |     |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |     |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |     |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |     |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |     |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |     |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |     |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |     |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |     |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |     |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |     |  |  ]
|  |  |  |  |     |     |  |  |
|  |  |  |  |     |     |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |     |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |     |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |     |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |     |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |     |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |     |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |     |  |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |     |  |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |     |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |     |  |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |     |     |  |  |  ]
|  |  |  |  |     |     |  |  |  |
|  |  |  |  |     |     |  |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |     |  |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |     |  |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |     |  |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |     |  |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |     |  |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |     |  |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |     |  |  |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |     |  |  |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |     |  |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |     |  |  |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |     |     |  |  |  |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |     |  |  |  |  ]
|  |  |  |  |     |     |  |  |  |
|  |  |  |  |     |     |  |  |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |     |  |  |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |     |  |  |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |     |  |  |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |     |  |  |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |     |  |  |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |     |  |  |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |     |  |  |     ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |     |  |  |     ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |     |  |  |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |     |  |  |     ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |     |     |  |  |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |     |     |  |  |     ]
|  |  |  |  |     |     |  |  |
|  |  |  |  |     |     |  |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |     |  |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |     |  |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |     |  |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |     |  |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |     |  |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |     |  |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |     |  |     ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |     |  |     ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |     |  |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |     |  |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk2)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |     |  |     ]
|  |  |  |  |     |     |  |     |
|  |  |  |  |     |     |  |     `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |     |  |        ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |     |  |        ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |     |  |        ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |     |  |        ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |     |  |        ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |     |  |        ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |     |  |        ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |     |  |        ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |     |  |        ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |     |  |        ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk2)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |     |  |        ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |     |     |  |        ]
|  |  |  |  |     |     |  |
|  |  |  |  |     |     |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |     |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |     |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |     |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |     |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |     |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |     |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |     |     ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |     |     ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |     |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk2)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |     |     ]
|  |  |  |  |     |     |     |
|  |  |  |  |     |     |     `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |     |        ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |     |        ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |     |        ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |     |        ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |     |        ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |     |        ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |     |        ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |     |        ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |     |        ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk2)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |     |        ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |     |        ]
|  |  |  |  |     |     |        |
|  |  |  |  |     |     |        `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |     |           ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |     |           ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |     |           ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |     |           ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |     |           ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |     |           ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |     |           ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |     |           ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |     |           ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk2)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |     |           ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |     |           ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |     |     |           ]
|  |  |  |  |     |     |
|  |  |  |  |     |     `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |        ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |        ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |        ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |        ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |        ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |        ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |        ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |        ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk2)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |        ]
|  |  |  |  |     |        |
|  |  |  |  |     |        +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |        |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |        |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |        |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |        |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |        |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |        |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |        |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |        |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk2)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |        |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |        |  ]
|  |  |  |  |     |        |  |
|  |  |  |  |     |        |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |        |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |        |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |        |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |        |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |        |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |        |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |        |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |        |  |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk2)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |        |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |        |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |     |        |  |  ]
|  |  |  |  |     |        |  |  |
|  |  |  |  |     |        |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |        |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |        |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |        |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |        |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |        |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |        |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |        |  |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |        |  |  |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk2)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |        |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |        |  |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |     |        |  |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |        |  |  |  ]
|  |  |  |  |     |        |  |  |
|  |  |  |  |     |        |  |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |        |  |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |        |  |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |        |  |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |        |  |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |        |  |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |        |  |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |        |  |     ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |        |  |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk2)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |        |  |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |        |  |     ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |     |        |  |     ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |     |        |  |     ]
|  |  |  |  |     |        |  |
|  |  |  |  |     |        |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |        |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |        |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |        |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |        |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |        |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |        |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |        |     ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |        |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk2)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |        |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |        |     ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |        |     ]
|  |  |  |  |     |        |     |
|  |  |  |  |     |        |     `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |        |        ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |        |        ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |        |        ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |        |        ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |        |        ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |        |        ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |        |        ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |        |        ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk2)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |        |        ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |        |        ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |        |        ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |     |        |        ]
|  |  |  |  |     |        |
|  |  |  |  |     |        `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |           ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |           ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |           ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |           ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |           ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |           ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |           ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |           ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk2)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |           ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |           ]
|  |  |  |  |     |           |
|  |  |  |  |     |           `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |              ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |              ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |              ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |              ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |              ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |              ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |              ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |              ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk2)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |              ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |              ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |              ]
|  |  |  |  |     |              |
|  |  |  |  |     |              `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |                 ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |                 ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |     |                 ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |     |                 ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |                 ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |     |                 ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |                 ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |                 ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk2)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |                 ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |  |     |                 ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |  |     |                 ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |     |                 ]
|  |  |  |  |     |
|  |  |  |  |     `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |        ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |        ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |        ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |        ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |        ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |        ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk2)⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |        ]
|  |  |  |  |        |
|  |  |  |  |        +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |        |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |        |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |        |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |        |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |        |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |        |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk2)⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |        |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk3)⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |        |  ]
|  |  |  |  |        |  |
|  |  |  |  |        |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |        |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |        |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |        |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |        |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |        |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |        |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk2)⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |        |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk3)⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |        |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |        |  |  ]
|  |  |  |  |        |  |  |
|  |  |  |  |        |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |        |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |        |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |        |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |        |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |        |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |        |  |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk2)⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |        |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk3)⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |        |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |        |  |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk3,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |        |  |  |  ]
|  |  |  |  |        |  |  |  |
|  |  |  |  |        |  |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |        |  |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |        |  |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |        |  |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |        |  |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |        |  |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |        |  |  |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk2)⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |        |  |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk3)⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |        |  |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |        |  |  |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk3,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |        |  |  |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |        |  |  |  |  ]
|  |  |  |  |        |  |  |  |  |
|  |  |  |  |        |  |  |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |        |  |  |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |        |  |  |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |        |  |  |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |        |  |  |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |        |  |  |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |        |  |  |  |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk2)⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |        |  |  |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk3)⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |        |  |  |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |        |  |  |  |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk3,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |        |  |  |  |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |        |  |  |  |  |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk3,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |        |  |  |  |  |  ]
|  |  |  |  |        |  |  |  |  |
|  |  |  |  |        |  |  |  |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |        |  |  |  |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |        |  |  |  |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |        |  |  |  |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |        |  |  |  |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |        |  |  |  |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |        |  |  |  |     ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk2)⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |        |  |  |  |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk3)⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |        |  |  |  |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |        |  |  |  |     ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk3,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |        |  |  |  |     ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |        |  |  |  |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk3,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |        |  |  |  |     ]
|  |  |  |  |        |  |  |  |
|  |  |  |  |        |  |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |        |  |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |        |  |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |        |  |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |        |  |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |        |  |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |        |  |  |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk2)⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |        |  |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk3)⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |        |  |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |        |  |  |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk3,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |        |  |  |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |        |  |  |  |  ]
|  |  |  |  |        |  |  |  |  |
|  |  |  |  |        |  |  |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |        |  |  |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |        |  |  |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |        |  |  |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |        |  |  |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |        |  |  |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |        |  |  |  |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk2)⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |        |  |  |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk3)⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |        |  |  |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |        |  |  |  |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk3,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |        |  |  |  |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |        |  |  |  |  |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk3,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |        |  |  |  |  |  ]
|  |  |  |  |        |  |  |  |  |
|  |  |  |  |        |  |  |  |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |        |  |  |  |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |        |  |  |  |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |        |  |  |  |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |        |  |  |  |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |        |  |  |  |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |        |  |  |  |     ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk2)⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |        |  |  |  |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk3)⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |        |  |  |  |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |        |  |  |  |     ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk3,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |        |  |  |  |     ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |        |  |  |  |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk3,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |        |  |  |  |     ]
|  |  |  |  |        |  |  |  |
|  |  |  |  |        |  |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |        |  |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |        |  |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |        |  |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |        |  |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |        |  |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |        |  |  |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk2)⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |        |  |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk3)⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |        |  |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |        |  |  |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk3,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |        |  |  |  |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk3,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |        |  |  |  |  ]
|  |  |  |  |        |  |  |  |  |
|  |  |  |  |        |  |  |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |        |  |  |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |        |  |  |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |        |  |  |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |        |  |  |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |        |  |  |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |        |  |  |  |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk2)⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |        |  |  |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk3)⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |        |  |  |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |        |  |  |  |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk3,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |        |  |  |  |  |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk3,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |        |  |  |  |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |        |  |  |  |  |  ]
|  |  |  |  |        |  |  |  |  |
|  |  |  |  |        |  |  |  |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |        |  |  |  |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |        |  |  |  |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |        |  |  |  |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |        |  |  |  |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |        |  |  |  |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |        |  |  |  |     ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk2)⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |        |  |  |  |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk3)⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |        |  |  |  |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |        |  |  |  |     ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk3,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |        |  |  |  |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk3,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |        |  |  |  |     ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |        |  |  |  |     ]
|  |  |  |  |        |  |  |  |
|  |  |  |  |        |  |  |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |        |  |  |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |        |  |  |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |        |  |  |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |        |  |  |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |        |  |  |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |        |  |  |     ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk2)⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |        |  |  |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk3)⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |        |  |  |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |        |  |  |     ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk3,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |        |  |  |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk3,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |        |  |  |     ]
|  |  |  |  |        |  |  |     |
|  |  |  |  |        |  |  |     +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |        |  |  |     |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |        |  |  |     |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |        |  |  |     |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |        |  |  |     |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |        |  |  |     |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |        |  |  |     |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk2)⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |        |  |  |     |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk3)⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |        |  |  |     |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |        |  |  |     |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk3,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |        |  |  |     |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk3,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |        |  |  |     |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |        |  |  |     |  ]
|  |  |  |  |        |  |  |     |
|  |  |  |  |        |  |  |     `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |        |  |  |        ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |        |  |  |        ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |        |  |  |        ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |        |  |  |        ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |        |  |  |        ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |        |  |  |        ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk2)⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |        |  |  |        ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk3)⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |        |  |  |        ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |        |  |  |        ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk3,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |        |  |  |        ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk3,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |        |  |  |        ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |        |  |  |        ]
|  |  |  |  |        |  |  |
|  |  |  |  |        |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |        |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |        |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |        |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |        |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |        |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |        |  |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk2)⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |        |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk3)⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |        |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |        |  |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |        |  |  |  ]
|  |  |  |  |        |  |  |  |
|  |  |  |  |        |  |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |        |  |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |        |  |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |        |  |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |        |  |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |        |  |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |        |  |  |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk2)⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |        |  |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk3)⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |        |  |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |        |  |  |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |        |  |  |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk3,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |        |  |  |  |  ]
|  |  |  |  |        |  |  |  |  |
|  |  |  |  |        |  |  |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |        |  |  |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |        |  |  |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |        |  |  |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |        |  |  |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |        |  |  |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |        |  |  |  |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk2)⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |        |  |  |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk3)⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |        |  |  |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |        |  |  |  |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |        |  |  |  |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk3,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |        |  |  |  |  |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk3,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |        |  |  |  |  |  ]
|  |  |  |  |        |  |  |  |  |
|  |  |  |  |        |  |  |  |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |        |  |  |  |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |        |  |  |  |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |        |  |  |  |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |        |  |  |  |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |        |  |  |  |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |        |  |  |  |     ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk2)⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |        |  |  |  |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk3)⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |        |  |  |  |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |        |  |  |  |     ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |        |  |  |  |     ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk3,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |        |  |  |  |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk3,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |        |  |  |  |     ]
|  |  |  |  |        |  |  |  |
|  |  |  |  |        |  |  |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |        |  |  |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |        |  |  |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |        |  |  |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |        |  |  |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |        |  |  |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |        |  |  |     ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk2)⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |        |  |  |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk3)⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |        |  |  |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |        |  |  |     ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |        |  |  |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk3)⟨kk3,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |        |  |  |     ]
|  |  |  |  |        |  |  |     |
|  |  |  |  |        |  |  |     `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |        |  |  |        ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |        |  |  |        ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |        |  |  |        ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |        |  |  |        ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |        |  |  |        ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |        |  |  |        ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk2)⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |        |  |  |        ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk3)⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |        |  |  |        ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |        |  |  |        ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |        |  |  |        ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk3)⟨kk3,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |        |  |  |        ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk3,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |        |  |  |        ]
|  |  |  |  |        |  |  |
|  |  |  |  |        |  |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |        |  |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |        |  |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |        |  |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |        |  |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |        |  |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |        |  |     ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk2)⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |        |  |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk3)⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |        |  |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |        |  |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk3)⟨kk3,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |        |  |     ]
|  |  |  |  |        |  |     |
|  |  |  |  |        |  |     +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |        |  |     |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |        |  |     |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |        |  |     |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |        |  |     |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |        |  |     |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |        |  |     |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk2)⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |        |  |     |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk3)⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |        |  |     |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |        |  |     |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk3)⟨kk3,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |        |  |     |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk3,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |        |  |     |  ]
|  |  |  |  |        |  |     |  |
|  |  |  |  |        |  |     |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |        |  |     |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |        |  |     |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |        |  |     |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |        |  |     |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |        |  |     |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |        |  |     |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk2)⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |        |  |     |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk3)⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |        |  |     |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |        |  |     |  |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk3)⟨kk3,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |        |  |     |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk3,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |        |  |     |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |        |  |     |  |  ]
|  |  |  |  |        |  |     |  |
|  |  |  |  |        |  |     |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |        |  |     |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |        |  |     |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |        |  |     |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |        |  |     |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |        |  |     |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |        |  |     |     ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk2)⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |        |  |     |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk3)⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |        |  |     |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |        |  |     |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk3)⟨kk3,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |        |  |     |     ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk3,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |        |  |     |     ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |        |  |     |     ]
|  |  |  |  |        |  |     |
|  |  |  |  |        |  |     `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |        |  |        ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |        |  |        ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |        |  |        ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |        |  |        ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |        |  |        ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |        |  |        ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk2)⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |        |  |        ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk3)⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |        |  |        ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |        |  |        ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk3)⟨kk3,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |        |  |        ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |        |  |        ]
|  |  |  |  |        |  |        |
|  |  |  |  |        |  |        `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |        |  |           ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |        |  |           ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |        |  |           ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |        |  |           ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |        |  |           ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |        |  |           ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk2)⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |        |  |           ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk3)⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |        |  |           ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |        |  |           ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk3)⟨kk3,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |        |  |           ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |        |  |           ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk3,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |        |  |           ]
|  |  |  |  |        |  |
|  |  |  |  |        |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |        |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |        |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |        |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |        |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |        |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |        |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk2)⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |        |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk3)⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |        |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |        |  |  ]
|  |  |  |  |        |  |  |
|  |  |  |  |        |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |        |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |        |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |        |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |        |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |        |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |        |  |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk2)⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |        |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk3)⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |        |  |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |        |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |        |  |  |  ]
|  |  |  |  |        |  |  |  |
|  |  |  |  |        |  |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |        |  |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |        |  |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |        |  |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |        |  |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |        |  |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |        |  |  |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk2)⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |        |  |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk3)⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |        |  |  |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |        |  |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |        |  |  |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk3,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |        |  |  |  |  ]
|  |  |  |  |        |  |  |  |  |
|  |  |  |  |        |  |  |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |        |  |  |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |        |  |  |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |        |  |  |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |        |  |  |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |        |  |  |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |        |  |  |  |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk2)⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |        |  |  |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk3)⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |        |  |  |  |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |        |  |  |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |        |  |  |  |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk3,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |        |  |  |  |  |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk3,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |        |  |  |  |  |  ]
|  |  |  |  |        |  |  |  |  |
|  |  |  |  |        |  |  |  |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |        |  |  |  |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |        |  |  |  |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |        |  |  |  |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |        |  |  |  |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |        |  |  |  |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |        |  |  |  |     ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk2)⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |        |  |  |  |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk3)⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |        |  |  |  |     ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |        |  |  |  |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |        |  |  |  |     ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk3,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |        |  |  |  |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk3,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |        |  |  |  |     ]
|  |  |  |  |        |  |  |  |
|  |  |  |  |        |  |  |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |        |  |  |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |        |  |  |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |        |  |  |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |        |  |  |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |        |  |  |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |        |  |  |     ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk2)⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |        |  |  |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk3)⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |        |  |  |     ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |        |  |  |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |        |  |  |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk3)⟨kk3,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |        |  |  |     ]
|  |  |  |  |        |  |  |     |
|  |  |  |  |        |  |  |     `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |        |  |  |        ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |        |  |  |        ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |        |  |  |        ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |        |  |  |        ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |        |  |  |        ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |        |  |  |        ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk2)⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |        |  |  |        ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk3)⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |        |  |  |        ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |        |  |  |        ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |        |  |  |        ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk3)⟨kk3,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |        |  |  |        ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk3,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |        |  |  |        ]
|  |  |  |  |        |  |  |
|  |  |  |  |        |  |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |        |  |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |        |  |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |        |  |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |        |  |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |        |  |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |        |  |     ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk2)⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |        |  |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk3)⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |        |  |     ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |        |  |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk3)⟨kk3,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |        |  |     ]
|  |  |  |  |        |  |     |
|  |  |  |  |        |  |     `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |        |  |        ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |        |  |        ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |        |  |        ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |        |  |        ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |        |  |        ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |        |  |        ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk2)⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |        |  |        ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk3)⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |        |  |        ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |        |  |        ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk3)⟨kk3,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |        |  |        ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |        |  |        ]
|  |  |  |  |        |  |        |
|  |  |  |  |        |  |        `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |        |  |           ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |        |  |           ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |        |  |           ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |        |  |           ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |        |  |           ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |        |  |           ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk2)⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |        |  |           ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk3)⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |        |  |           ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |        |  |           ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk3)⟨kk3,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |        |  |           ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |        |  |           ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk3,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |        |  |           ]
|  |  |  |  |        |  |
|  |  |  |  |        |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |        |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |        |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |        |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |        |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |        |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |        |     ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk2)⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |        |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk3)⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |        |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk3)⟨kk3,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |        |     ]
|  |  |  |  |        |     |
|  |  |  |  |        |     +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |        |     |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |        |     |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |        |     |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |        |     |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |        |     |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |        |     |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk2)⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |        |     |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk3)⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |        |     |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk3)⟨kk3,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |        |     |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |        |     |  ]
|  |  |  |  |        |     |  |
|  |  |  |  |        |     |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |        |     |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |        |     |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |        |     |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |        |     |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |        |     |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |        |     |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk2)⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |        |     |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk3)⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |        |     |  |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk3)⟨kk3,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |        |     |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |        |     |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk3,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |        |     |  |  ]
|  |  |  |  |        |     |  |  |
|  |  |  |  |        |     |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |        |     |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |        |     |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |        |     |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |        |     |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |        |     |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |        |     |  |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk2)⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |        |     |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk3)⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |        |     |  |  |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk3)⟨kk3,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |        |     |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |        |     |  |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk3,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |        |     |  |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |        |     |  |  |  ]
|  |  |  |  |        |     |  |  |
|  |  |  |  |        |     |  |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |        |     |  |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |        |     |  |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |        |     |  |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |        |     |  |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |        |     |  |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |        |     |  |     ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk2)⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |        |     |  |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk3)⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |        |     |  |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk3)⟨kk3,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |        |     |  |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |        |     |  |     ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk3,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |        |     |  |     ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |        |     |  |     ]
|  |  |  |  |        |     |  |
|  |  |  |  |        |     |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |        |     |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |        |     |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |        |     |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |        |     |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |        |     |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |        |     |     ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk2)⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |        |     |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk3)⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |        |     |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk3)⟨kk3,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |        |     |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |        |     |     ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |        |     |     ]
|  |  |  |  |        |     |     |
|  |  |  |  |        |     |     `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |        |     |        ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |        |     |        ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |        |     |        ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |        |     |        ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |        |     |        ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |        |     |        ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk2)⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |        |     |        ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk3)⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |        |     |        ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk3)⟨kk3,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |        |     |        ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |        |     |        ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |        |     |        ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk3,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |        |     |        ]
|  |  |  |  |        |     |
|  |  |  |  |        |     `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |        |        ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |        |        ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |        |        ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |        |        ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |        |        ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |        |        ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk2)⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |        |        ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk3)⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |        |        ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk3)⟨kk3,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |        |        ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |        |        ]
|  |  |  |  |        |        |
|  |  |  |  |        |        `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |        |           ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |        |           ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |        |           ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |        |           ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |        |           ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |        |           ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk2)⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |        |           ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk3)⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |        |           ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk3)⟨kk3,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |        |           ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |        |           ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |        |           ]
|  |  |  |  |        |           |
|  |  |  |  |        |           `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |        |              ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |        |              ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |        |              ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |        |              ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |        |              ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |        |              ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk2)⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |        |              ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk3)⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |        |              ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk3)⟨kk3,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |        |              ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |        |              ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |        |              ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk3,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |        |              ]
|  |  |  |  |        |
|  |  |  |  |        `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |           ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |           ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |           ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |           ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |           ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |           ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk2)⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |           ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |           ]
|  |  |  |  |           |
|  |  |  |  |           `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |              ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |              ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |              ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |              ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |              ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |              ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk2)⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |              ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |              ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk3)⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |              ]
|  |  |  |  |              |
|  |  |  |  |              +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |              |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |              |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |              |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |              |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |              |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |              |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk2)⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |              |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |              |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk3)⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |              |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |              |  ]
|  |  |  |  |              |  |
|  |  |  |  |              |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |              |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |              |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |              |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |              |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |              |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |              |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk2)⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |              |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |              |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk3)⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |              |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |              |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk3,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |              |  |  ]
|  |  |  |  |              |  |  |
|  |  |  |  |              |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |              |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |              |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |              |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |              |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |              |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |              |  |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk2)⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |              |  |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |              |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk3)⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |              |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |              |  |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk3,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |              |  |  |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk3,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |              |  |  |  ]
|  |  |  |  |              |  |  |
|  |  |  |  |              |  |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |              |  |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |              |  |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |              |  |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |              |  |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |              |  |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |              |  |     ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk2)⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |              |  |     ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |              |  |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk3)⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |              |  |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |              |  |     ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk3,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |              |  |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk3,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |              |  |     ]
|  |  |  |  |              |  |
|  |  |  |  |              |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |              |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |              |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |              |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |              |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |              |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |              |     ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk2)⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |              |     ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |              |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk3)⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |              |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |              |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk3)⟨kk3,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |              |     ]
|  |  |  |  |              |     |
|  |  |  |  |              |     `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |              |        ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |              |        ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |              |        ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |              |        ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |              |        ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |              |        ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk2)⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |              |        ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |              |        ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk3)⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |              |        ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |              |        ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk3)⟨kk3,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |              |        ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk3,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |              |        ]
|  |  |  |  |              |
|  |  |  |  |              `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |                 ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |                 ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |                 ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |                 ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |                 ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |                 ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk2)⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |                 ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |                 ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk3)⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |                 ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk3)⟨kk3,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |                 ]
|  |  |  |  |                 |
|  |  |  |  |                 `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |                    ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |                    ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |                    ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |                    ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |                    ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |                    ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk2)⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |                    ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |                    ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk3)⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |                    ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk3)⟨kk3,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |                    ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |                    ]
|  |  |  |  |                    |
|  |  |  |  |                    `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |                       ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |                       ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |  |                       ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |  |                       ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |                       ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |  |                       ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk2)⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |                       ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |                       ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n4,kk3)⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |                       ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk3)⟨kk3,⦃kk2⦄_k_d1s1⟩
|  |  |  |  |                       ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk3⟩⦄_k_d1s1
|  |  |  |  |                       ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk3,⦃kk4⦄_k_d1s1⟩
|  |  |  |  |                       ]
|  |  |  |  |
|  |  |  |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |     ]
|  |  |  |     |
|  |  |  |     +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |     |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |     |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |     |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |     |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |     |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |     |  ]
|  |  |  |     |  |
|  |  |  |     |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |     |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |     |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |     |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |     |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |     |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |     |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |     |  |  ]
|  |  |  |     |  |  |
|  |  |  |     |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |     |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |     |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |     |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |     |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |     |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |     |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |     |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |     |  |  |  ]
|  |  |  |     |  |  |  |
|  |  |  |     |  |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |     |  |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |     |  |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |     |  |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |     |  |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |     |  |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |     |  |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |     |  |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |     |  |  |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |     |  |  |  |  ]
|  |  |  |     |  |  |  |  |
|  |  |  |     |  |  |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |     |  |  |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |     |  |  |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |     |  |  |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |     |  |  |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |     |  |  |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |     |  |  |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |     |  |  |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |     |  |  |  |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |     |  |  |  |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |     |  |  |  |  |  ]
|  |  |  |     |  |  |  |  |  |
|  |  |  |     |  |  |  |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |     |  |  |  |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |     |  |  |  |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |     |  |  |  |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |     |  |  |  |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |     |  |  |  |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |     |  |  |  |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |     |  |  |  |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |     |  |  |  |  |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |     |  |  |  |  |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |     |  |  |  |  |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |     |  |  |  |  |  |  ]
|  |  |  |     |  |  |  |  |  |  |
|  |  |  |     |  |  |  |  |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |     |  |  |  |  |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |     |  |  |  |  |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |     |  |  |  |  |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |     |  |  |  |  |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |     |  |  |  |  |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |     |  |  |  |  |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |     |  |  |  |  |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |     |  |  |  |  |  |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |     |  |  |  |  |  |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |     |  |  |  |  |  |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |     |  |  |  |  |  |  |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |     |  |  |  |  |  |  |  ]
|  |  |  |     |  |  |  |  |  |  |
|  |  |  |     |  |  |  |  |  |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |     |  |  |  |  |  |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |     |  |  |  |  |  |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |     |  |  |  |  |  |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |     |  |  |  |  |  |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |     |  |  |  |  |  |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |     |  |  |  |  |  |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |     |  |  |  |  |  |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |     |  |  |  |  |  |     ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |     |  |  |  |  |  |     ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |     |  |  |  |  |  |     ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |     |  |  |  |  |  |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |     |  |  |  |  |  |     ]
|  |  |  |     |  |  |  |  |  |
|  |  |  |     |  |  |  |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |     |  |  |  |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |     |  |  |  |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |     |  |  |  |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |     |  |  |  |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |     |  |  |  |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |     |  |  |  |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |     |  |  |  |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |     |  |  |  |  |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |     |  |  |  |  |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |     |  |  |  |  |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |     |  |  |  |  |  |  ]
|  |  |  |     |  |  |  |  |  |  |
|  |  |  |     |  |  |  |  |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |     |  |  |  |  |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |     |  |  |  |  |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |     |  |  |  |  |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |     |  |  |  |  |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |     |  |  |  |  |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |     |  |  |  |  |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |     |  |  |  |  |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |     |  |  |  |  |  |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |     |  |  |  |  |  |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |     |  |  |  |  |  |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |     |  |  |  |  |  |  |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |     |  |  |  |  |  |  |  ]
|  |  |  |     |  |  |  |  |  |  |
|  |  |  |     |  |  |  |  |  |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |     |  |  |  |  |  |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |     |  |  |  |  |  |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |     |  |  |  |  |  |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |     |  |  |  |  |  |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |     |  |  |  |  |  |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |     |  |  |  |  |  |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |     |  |  |  |  |  |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |     |  |  |  |  |  |     ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |     |  |  |  |  |  |     ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |     |  |  |  |  |  |     ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |     |  |  |  |  |  |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |     |  |  |  |  |  |     ]
|  |  |  |     |  |  |  |  |  |
|  |  |  |     |  |  |  |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |     |  |  |  |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |     |  |  |  |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |     |  |  |  |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |     |  |  |  |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |     |  |  |  |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |     |  |  |  |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |     |  |  |  |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |     |  |  |  |  |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |     |  |  |  |  |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |     |  |  |  |  |  |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |     |  |  |  |  |  |  ]
|  |  |  |     |  |  |  |  |  |  |
|  |  |  |     |  |  |  |  |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |     |  |  |  |  |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |     |  |  |  |  |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |     |  |  |  |  |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |     |  |  |  |  |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |     |  |  |  |  |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |     |  |  |  |  |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |     |  |  |  |  |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |     |  |  |  |  |  |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |     |  |  |  |  |  |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |     |  |  |  |  |  |  |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |     |  |  |  |  |  |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |     |  |  |  |  |  |  |  ]
|  |  |  |     |  |  |  |  |  |  |
|  |  |  |     |  |  |  |  |  |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |     |  |  |  |  |  |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |     |  |  |  |  |  |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |     |  |  |  |  |  |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |     |  |  |  |  |  |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |     |  |  |  |  |  |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |     |  |  |  |  |  |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |     |  |  |  |  |  |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |     |  |  |  |  |  |     ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |     |  |  |  |  |  |     ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |     |  |  |  |  |  |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |     |  |  |  |  |  |     ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |     |  |  |  |  |  |     ]
|  |  |  |     |  |  |  |  |  |
|  |  |  |     |  |  |  |  |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |     |  |  |  |  |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |     |  |  |  |  |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |     |  |  |  |  |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |     |  |  |  |  |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |     |  |  |  |  |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |     |  |  |  |  |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |     |  |  |  |  |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |     |  |  |  |  |     ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |     |  |  |  |  |     ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |     |  |  |  |  |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |     |  |  |  |  |     ]
|  |  |  |     |  |  |  |  |     |
|  |  |  |     |  |  |  |  |     +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |     |  |  |  |  |     |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |     |  |  |  |  |     |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |     |  |  |  |  |     |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |     |  |  |  |  |     |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |     |  |  |  |  |     |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |     |  |  |  |  |     |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |     |  |  |  |  |     |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |     |  |  |  |  |     |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |     |  |  |  |  |     |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |     |  |  |  |  |     |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |     |  |  |  |  |     |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |     |  |  |  |  |     |  ]
|  |  |  |     |  |  |  |  |     |
|  |  |  |     |  |  |  |  |     `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |     |  |  |  |  |        ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |     |  |  |  |  |        ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |     |  |  |  |  |        ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |     |  |  |  |  |        ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |     |  |  |  |  |        ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |     |  |  |  |  |        ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |     |  |  |  |  |        ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |     |  |  |  |  |        ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |     |  |  |  |  |        ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |     |  |  |  |  |        ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |     |  |  |  |  |        ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |     |  |  |  |  |        ]
|  |  |  |     |  |  |  |  |
|  |  |  |     |  |  |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |     |  |  |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |     |  |  |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |     |  |  |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |     |  |  |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |     |  |  |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |     |  |  |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |     |  |  |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |     |  |  |  |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |     |  |  |  |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: (kk2)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |     |  |  |  |  |  ]
|  |  |  |     |  |  |  |  |  |
|  |  |  |     |  |  |  |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |     |  |  |  |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |     |  |  |  |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |     |  |  |  |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |     |  |  |  |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |     |  |  |  |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |     |  |  |  |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |     |  |  |  |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |     |  |  |  |  |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |     |  |  |  |  |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: (kk2)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |     |  |  |  |  |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |     |  |  |  |  |  |  ]
|  |  |  |     |  |  |  |  |  |  |
|  |  |  |     |  |  |  |  |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |     |  |  |  |  |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |     |  |  |  |  |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |     |  |  |  |  |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |     |  |  |  |  |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |     |  |  |  |  |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |     |  |  |  |  |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |     |  |  |  |  |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |     |  |  |  |  |  |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |     |  |  |  |  |  |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: (kk2)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |     |  |  |  |  |  |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |     |  |  |  |  |  |  |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |     |  |  |  |  |  |  |  ]
|  |  |  |     |  |  |  |  |  |  |
|  |  |  |     |  |  |  |  |  |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |     |  |  |  |  |  |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |     |  |  |  |  |  |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |     |  |  |  |  |  |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |     |  |  |  |  |  |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |     |  |  |  |  |  |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |     |  |  |  |  |  |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |     |  |  |  |  |  |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |     |  |  |  |  |  |     ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |     |  |  |  |  |  |     ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: (kk2)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |     |  |  |  |  |  |     ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |     |  |  |  |  |  |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |     |  |  |  |  |  |     ]
|  |  |  |     |  |  |  |  |  |
|  |  |  |     |  |  |  |  |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |     |  |  |  |  |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |     |  |  |  |  |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |     |  |  |  |  |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |     |  |  |  |  |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |     |  |  |  |  |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |     |  |  |  |  |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |     |  |  |  |  |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |     |  |  |  |  |     ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |     |  |  |  |  |     ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: (kk2)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |     |  |  |  |  |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |     |  |  |  |  |     ]
|  |  |  |     |  |  |  |  |     |
|  |  |  |     |  |  |  |  |     `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |     |  |  |  |  |        ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |     |  |  |  |  |        ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |     |  |  |  |  |        ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |     |  |  |  |  |        ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |     |  |  |  |  |        ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |     |  |  |  |  |        ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |     |  |  |  |  |        ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |     |  |  |  |  |        ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |     |  |  |  |  |        ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: (kk2)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |     |  |  |  |  |        ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |     |  |  |  |  |        ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |     |  |  |  |  |        ]
|  |  |  |     |  |  |  |  |
|  |  |  |     |  |  |  |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |     |  |  |  |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |     |  |  |  |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |     |  |  |  |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |     |  |  |  |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |     |  |  |  |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |     |  |  |  |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |     |  |  |  |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |     |  |  |  |     ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |     |  |  |  |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |     |  |  |  |     ]
|  |  |  |     |  |  |  |     |
|  |  |  |     |  |  |  |     +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |     |  |  |  |     |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |     |  |  |  |     |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |     |  |  |  |     |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |     |  |  |  |     |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |     |  |  |  |     |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |     |  |  |  |     |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |     |  |  |  |     |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |     |  |  |  |     |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |     |  |  |  |     |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |     |  |  |  |     |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |     |  |  |  |     |  ]
|  |  |  |     |  |  |  |     |  |
|  |  |  |     |  |  |  |     |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |     |  |  |  |     |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |     |  |  |  |     |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |     |  |  |  |     |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |     |  |  |  |     |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |     |  |  |  |     |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |     |  |  |  |     |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |     |  |  |  |     |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |     |  |  |  |     |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |     |  |  |  |     |  |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |     |  |  |  |     |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |     |  |  |  |     |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |     |  |  |  |     |  |  ]
|  |  |  |     |  |  |  |     |  |
|  |  |  |     |  |  |  |     |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |     |  |  |  |     |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |     |  |  |  |     |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |     |  |  |  |     |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |     |  |  |  |     |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |     |  |  |  |     |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |     |  |  |  |     |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |     |  |  |  |     |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |     |  |  |  |     |     ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |     |  |  |  |     |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |     |  |  |  |     |     ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |     |  |  |  |     |     ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |     |  |  |  |     |     ]
|  |  |  |     |  |  |  |     |
|  |  |  |     |  |  |  |     `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |     |  |  |  |        ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |     |  |  |  |        ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |     |  |  |  |        ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |     |  |  |  |        ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |     |  |  |  |        ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |     |  |  |  |        ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |     |  |  |  |        ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |     |  |  |  |        ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |     |  |  |  |        ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |     |  |  |  |        ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: (kk2)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |     |  |  |  |        ]
|  |  |  |     |  |  |  |        |
|  |  |  |     |  |  |  |        `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |     |  |  |  |           ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |     |  |  |  |           ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |     |  |  |  |           ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |     |  |  |  |           ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |     |  |  |  |           ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |     |  |  |  |           ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |     |  |  |  |           ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |     |  |  |  |           ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk3)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |     |  |  |  |           ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |     |  |  |  |           ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: (kk2)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |     |  |  |  |           ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk4)⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |     |  |  |  |           ]
|  |  |  |     |  |  |  |
|  |  |  |     |  |  |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |     |  |  |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |     |  |  |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |     |  |  |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |     |  |  |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |     |  |  |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |     |  |  |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |     |  |  |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |     |  |  |     ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |     |  |  |     ]
|  |  |  |     |  |  |     |
|  |  |  |     |  |  |     +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |     |  |  |     |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |     |  |  |     |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |     |  |  |     |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |     |  |  |     |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |     |  |  |     |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |     |  |  |     |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |     |  |  |     |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |     |  |  |     |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |     |  |  |     |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |     |  |  |     |  ]
|  |  |  |     |  |  |     |  |
|  |  |  |     |  |  |     |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |     |  |  |     |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |     |  |  |     |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |     |  |  |     |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |     |  |  |     |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |     |  |  |     |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |     |  |  |     |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |     |  |  |     |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |     |  |  |     |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |     |  |  |     |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |     |  |  |     |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |     |  |  |     |  |  ]
|  |  |  |     |  |  |     |  |  |
|  |  |  |     |  |  |     |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |     |  |  |     |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |     |  |  |     |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |     |  |  |     |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |     |  |  |     |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |     |  |  |     |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |     |  |  |     |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |     |  |  |     |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |     |  |  |     |  |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |     |  |  |     |  |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |     |  |  |     |  |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |     |  |  |     |  |  |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |     |  |  |     |  |  |  ]
|  |  |  |     |  |  |     |  |  |
|  |  |  |     |  |  |     |  |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |     |  |  |     |  |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |     |  |  |     |  |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |     |  |  |     |  |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |     |  |  |     |  |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |     |  |  |     |  |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |     |  |  |     |  |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |     |  |  |     |  |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |     |  |  |     |  |     ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |     |  |  |     |  |     ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |     |  |  |     |  |     ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |     |  |  |     |  |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |     |  |  |     |  |     ]
|  |  |  |     |  |  |     |  |
|  |  |  |     |  |  |     |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |     |  |  |     |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |     |  |  |     |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |     |  |  |     |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |     |  |  |     |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |     |  |  |     |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |     |  |  |     |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |     |  |  |     |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |     |  |  |     |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |     |  |  |     |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |     |  |  |     |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |     |  |  |     |  |  ]
|  |  |  |     |  |  |     |  |  |
|  |  |  |     |  |  |     |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |     |  |  |     |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |     |  |  |     |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |     |  |  |     |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |     |  |  |     |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |     |  |  |     |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |     |  |  |     |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |     |  |  |     |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |     |  |  |     |  |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |     |  |  |     |  |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |     |  |  |     |  |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |     |  |  |     |  |  |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |     |  |  |     |  |  |  ]
|  |  |  |     |  |  |     |  |  |
|  |  |  |     |  |  |     |  |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |     |  |  |     |  |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |     |  |  |     |  |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |     |  |  |     |  |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |     |  |  |     |  |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |     |  |  |     |  |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |     |  |  |     |  |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |     |  |  |     |  |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |     |  |  |     |  |     ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |     |  |  |     |  |     ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |     |  |  |     |  |     ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |     |  |  |     |  |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |     |  |  |     |  |     ]
|  |  |  |     |  |  |     |  |
|  |  |  |     |  |  |     |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |     |  |  |     |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |     |  |  |     |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |     |  |  |     |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |     |  |  |     |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |     |  |  |     |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |     |  |  |     |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |     |  |  |     |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |     |  |  |     |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |     |  |  |     |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |     |  |  |     |  |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |     |  |  |     |  |  ]
|  |  |  |     |  |  |     |  |  |
|  |  |  |     |  |  |     |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |     |  |  |     |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |     |  |  |     |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |     |  |  |     |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |     |  |  |     |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |     |  |  |     |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |     |  |  |     |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |     |  |  |     |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |     |  |  |     |  |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |     |  |  |     |  |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |     |  |  |     |  |  |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |     |  |  |     |  |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |     |  |  |     |  |  |  ]
|  |  |  |     |  |  |     |  |  |
|  |  |  |     |  |  |     |  |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |     |  |  |     |  |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |     |  |  |     |  |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |     |  |  |     |  |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |     |  |  |     |  |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |     |  |  |     |  |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |     |  |  |     |  |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |     |  |  |     |  |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |     |  |  |     |  |     ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |     |  |  |     |  |     ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |     |  |  |     |  |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |     |  |  |     |  |     ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |     |  |  |     |  |     ]
|  |  |  |     |  |  |     |  |
|  |  |  |     |  |  |     |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |     |  |  |     |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |     |  |  |     |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |     |  |  |     |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |     |  |  |     |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |     |  |  |     |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |     |  |  |     |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |     |  |  |     |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |     |  |  |     |     ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |     |  |  |     |     ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |     |  |  |     |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |     |  |  |     |     ]
|  |  |  |     |  |  |     |     |
|  |  |  |     |  |  |     |     +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |     |  |  |     |     |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |     |  |  |     |     |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |     |  |  |     |     |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |     |  |  |     |     |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |     |  |  |     |     |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |     |  |  |     |     |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |     |  |  |     |     |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |     |  |  |     |     |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |     |  |  |     |     |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |     |  |  |     |     |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |     |  |  |     |     |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |     |  |  |     |     |  ]
|  |  |  |     |  |  |     |     |
|  |  |  |     |  |  |     |     `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |     |  |  |     |        ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |     |  |  |     |        ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |     |  |  |     |        ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |     |  |  |     |        ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |     |  |  |     |        ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |     |  |  |     |        ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |     |  |  |     |        ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |     |  |  |     |        ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |     |  |  |     |        ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |     |  |  |     |        ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |     |  |  |     |        ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |     |  |  |     |        ]
|  |  |  |     |  |  |     |
|  |  |  |     |  |  |     +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |     |  |  |     |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |     |  |  |     |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |     |  |  |     |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |     |  |  |     |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |     |  |  |     |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |     |  |  |     |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |     |  |  |     |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |     |  |  |     |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |     |  |  |     |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |     |  |  |     |  ]
|  |  |  |     |  |  |     |  |
|  |  |  |     |  |  |     |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |     |  |  |     |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |     |  |  |     |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |     |  |  |     |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |     |  |  |     |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |     |  |  |     |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |     |  |  |     |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |     |  |  |     |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |     |  |  |     |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |     |  |  |     |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |     |  |  |     |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |     |  |  |     |  |  ]
|  |  |  |     |  |  |     |  |  |
|  |  |  |     |  |  |     |  |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |     |  |  |     |  |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |     |  |  |     |  |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |     |  |  |     |  |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |     |  |  |     |  |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |     |  |  |     |  |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |     |  |  |     |  |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |     |  |  |     |  |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |     |  |  |     |  |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |     |  |  |     |  |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |     |  |  |     |  |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |     |  |  |     |  |  |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |     |  |  |     |  |  |  ]
|  |  |  |     |  |  |     |  |  |
|  |  |  |     |  |  |     |  |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |     |  |  |     |  |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |     |  |  |     |  |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |     |  |  |     |  |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |     |  |  |     |  |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |     |  |  |     |  |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |     |  |  |     |  |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |     |  |  |     |  |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |     |  |  |     |  |     ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |     |  |  |     |  |     ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |     |  |  |     |  |     ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |     |  |  |     |  |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |     |  |  |     |  |     ]
|  |  |  |     |  |  |     |  |
|  |  |  |     |  |  |     |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |     |  |  |     |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |     |  |  |     |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |     |  |  |     |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |     |  |  |     |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |     |  |  |     |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |     |  |  |     |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |     |  |  |     |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |     |  |  |     |     ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |     |  |  |     |     ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |     |  |  |     |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk1)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |     |  |  |     |     ]
|  |  |  |     |  |  |     |     |
|  |  |  |     |  |  |     |     `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |     |  |  |     |        ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |     |  |  |     |        ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |     |  |  |     |        ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |     |  |  |     |        ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |     |  |  |     |        ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |     |  |  |     |        ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |     |  |  |     |        ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |     |  |  |     |        ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |     |  |  |     |        ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |     |  |  |     |        ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk1)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |     |  |  |     |        ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |     |  |  |     |        ]
|  |  |  |     |  |  |     |
|  |  |  |     |  |  |     `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |     |  |  |        ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |     |  |  |        ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |     |  |  |        ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |     |  |  |        ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |     |  |  |        ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |     |  |  |        ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |     |  |  |        ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |     |  |  |        ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |     |  |  |        ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk1)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |     |  |  |        ]
|  |  |  |     |  |  |        |
|  |  |  |     |  |  |        +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |     |  |  |        |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |     |  |  |        |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |     |  |  |        |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |     |  |  |        |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |     |  |  |        |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |     |  |  |        |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |     |  |  |        |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |     |  |  |        |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |     |  |  |        |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk1)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |     |  |  |        |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |     |  |  |        |  ]
|  |  |  |     |  |  |        |  |
|  |  |  |     |  |  |        |  +- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |     |  |  |        |  |  ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |     |  |  |        |  |  ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |     |  |  |        |  |  ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |     |  |  |        |  |  ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |     |  |  |        |  |  ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |     |  |  |        |  |  ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |     |  |  |        |  |  ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |     |  |  |        |  |  ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |     |  |  |        |  |  ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk1)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |     |  |  |        |  |  ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |     |  |  |        |  |  ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |     |  |  |        |  |  ]
|  |  |  |     |  |  |        |  |
|  |  |  |     |  |  |        |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |     |  |  |        |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |     |  |  |        |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |     |  |  |        |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |     |  |  |        |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |     |  |  |        |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |     |  |  |        |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |     |  |  |        |     ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |     |  |  |        |     ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |     |  |  |        |     ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk1)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |     |  |  |        |     ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |     |  |  |        |     ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk4⦄_k_d1s1⟩
|  |  |  |     |  |  |        |     ]
|  |  |  |     |  |  |        |
|  |  |  |     |  |  |        `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |     |  |  |           ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |     |  |  |           ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |     |  |  |           ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |     |  |  |           ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |     |  |  |           ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |     |  |  |           ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |     |  |  |           ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |     |  |  |           ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |     |  |  |           ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk1)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |     |  |  |           ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |     |  |  |           ]
|  |  |  |     |  |  |           |
|  |  |  |     |  |  |           `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |     |  |  |              ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |     |  |  |              ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |     |  |  |              ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |     |  |  |              ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |     |  |  |              ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |     |  |  |              ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |     |  |  |              ,2.(d1,D,2,[d1,s1,k_d1s1])?: ()⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |     |  |  |              ,3.(d1,D,2,[d1,s1,k_d1s1])!: (kk3)⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |     |  |  |              ,3.(s1,S,2,[s1,k_d1s1,k_d2s1])?: (kk1)⟨kk1,⦃kk3⦄_k_d1s1⟩
|  |  |  |     |  |  |              ,3.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨kk2,⦃kk3⦄_k_d1s1⟩
|  |  |  |     |  |  |              ,3.(d1,D,1,[d1,s1,k_d1s1])!: (kk4)⟨kk1,⦃kk4⦄_k_d1s1⟩
|  |  |  |     |  |  |              ]
|  |  |  |     |  |  |
|  |  |  |     |  |  `- [1.(d1,D,1,[d1,s1,k_d1s1])!: (n1)⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |     |  |     ,1.(d1,D,2,[d1,s1,k_d1s1])!: (n2)⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |     |  |     ,1.(s1,S,1,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n1⟩,mac(⟨s1,d1,n1⟩;k_d1s1)⟩
|  |  |  |     |  |     ,1.(s1,S,2,[s1,k_d1s1,k_d2s1])?: ()⟨⟨s1,d1,n2⟩,mac(⟨s1,d1,n2⟩;k_d1s1)⟩
|  |  |  |     |  |     ,2.(s1,S,2,[s1,k_d1s1,k_d2s1])!: (n3,kk1)⦃⟨n3,kk1⟩⦄_k_d1s1
|  |  |  |     |  |     ,2.(s1,S,1,[s1,k_d1s1,k_d2s1])!: (n4,kk2)⦃⟨n4,kk2⟩⦄_k_d1s1
|  |  |  |     |  |     ,2.(d1,D,1,[d1,s1,k_d1s1])?: ()⦃⟨n3,kk1